<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CDI IELTS Reading Test - Improving Patient Safety</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Main styles */
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            overflow: hidden;
            background-color: #f0f8ff; /* Pale blue background */
        }
     
        .test-wrapper {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
     
        .test-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
     
        /* Header styles */
        .header {
            background-color: #fff;
            border-bottom: 1px solid #ddd;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
     
        .header__logo img {
            height: 40px;
        }
     
        .header__timer {
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
            background-color: #e6f2ff; /* Lighter blue for timer */
            padding: 5px 15px;
            border-radius: 20px;
            border: 1px solid #ddd;
            transition: all 0.3s ease;
        }
     
        .header__icons {
            display: flex;
            gap: 15px;
        }
     
        .header__icon {
            font-size: 1.2rem;
            color: #666;
            cursor: pointer;
        }
     
        /* Settings Modal */
        .settings-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
     
        .settings-content {
            background-color: white;
            width: 90%;
            max-width: 500px;
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
     
        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid #ddd;
            background-color: #f0f8ff; /* Pale blue background */
        }
     
        .settings-header h2 {
            margin: 0;
            font-size: 1.2rem;
        }
     
        .settings-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }
     
        .settings-body {
            padding: 20px;
        }
     
        .settings-option {
            display: flex;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
            cursor: pointer;
        }
     
        .settings-option:last-child {
            border-bottom: none;
        }
     
        .settings-option i {
            margin-right: 15px;
            width: 20px;
            text-align: center;
            color: #2a6c96;
        }
     
        .settings-option span {
            flex: 1;
        }
     
        .sectionRubric {
            margin: 1em;
            width: calc(100% - 4em - 3px);
            border-radius: 4px;
            padding: 0.75em 1em;
            background: white;
            border: 1px solid #d5d5d5;
        }
     
        .sectionRubric h2, .sectionRubric p {
            margin: 0;
        }
     
        .sectionRubric h2 {
            font-size: 1rem;
            margin-bottom: 0.25em;
        }
     
        /* Passage container */
        .passage-container {
            width: 45%;
            height: 100%;
            overflow-y: auto;
            padding: 20px;
            box-sizing: border-box;
            background-color: #f0f8ff; /* Pale blue */
            position: relative;
            -webkit-user-select: text;
            user-select: text;
        }
     
        /* Questions container */
        .questions-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            box-sizing: border-box;
            background-color: #f0f8ff; /* Pale blue */
            -webkit-user-select: text;
            user-select: text;
        }
     
        /* Highlight styles */
        .highlight {
            position: relative;
            border-radius: 2px;
            padding: 0 1px;
            margin: 0 -1px;
        }
     
        .highlight.yellow {
            background-color: rgba(255, 255, 0, 0.3);
        }
     
        .highlight.green {
            background-color: rgba(0, 255, 0, 0.3);
        }
     
        .highlight.pink {
            background-color: rgba(255, 105, 180, 0.3);
        }
     
        .highlight.blue {
            background-color: rgba(0, 191, 255, 0.3);
        }
     
        .highlight-toolbar {
            position: fixed;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            display: none;
            z-index: 1000;
            padding: 5px;
            transform: translate(-50%, -100%);
            margin-top: -5px;
        }
     
        .highlight-toolbar button {
            background: none;
            border: none;
            width: 24px;
            height: 24px;
            cursor: pointer;
            margin: 0 2px;
            border-radius: 3px;
        }
     
        .highlight-toolbar button:hover {
            background: #f0f0f0;
        }
     
        .highlight-toolbar button.remove {
            color: #ff0000;
        }
     
        /* Divider styling */
        .divider {
            width: 10px;
            background: #ddd;
            cursor: col-resize;
            position: relative;
        }
     
        .divider-handle {
            width: 4px;
            height: 40px;
            background: #999;
            border-radius: 2px;
            position: absolute;
            top: 50%;
            left: 3px;
            transform: translateY(-50%);
        }
     
        /* Question styling */
        .question {
            margin-bottom: 30px;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
     
        .question-rubric {
            margin-bottom: 15px;
            font-weight: bold;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
     
        .question-options {
            list-style-type: none;
            padding: 0;
        }
     
        .question-options li {
            margin: 10px 0;
            display: flex;
            align-items: center;
        }
     
        /* Multiple choice questions */
        .mcq-option {
            display: flex;
            align-items: center;
            margin: 5px 0;
            padding: 8px;
            border-radius: 4px;
        }
     
        .mcq-option input[type="radio"] {
            margin-right: 10px;
        }
        .mcq-option label {
            cursor: pointer;
        }
     
        /* Footer styles */
        .footer {
            background: #f5f5f5;
            border-top: 1px solid #ddd;
            padding: 10px;
        }
     
        .nav-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
     
        .footer__questionWrapper {
            display: flex;
            align-items: center;
        }
     
        .footer__questionNo {
            background: none;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            font-weight: bold;
        }
     
        .footer__subquestionWrapper {
            display: flex;
            flex-wrap: wrap;
            margin-left: 10px;
        }
     
        .subQuestion {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 1px solid #ccc;
            background: #f0f0f0;
            margin: 2px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            transition: all 0.2s ease-in-out;
        }
        .subQuestion:hover {
            transform: scale(1.1);
            border-color: #0066cc;
        }
     
        .subQuestion.active {
            background: #0066cc;
            color: white;
            border-color: #0066cc;
            font-weight: bold;
        }
     
        .subQuestion.attempted {
            background: #0066cc;
            color: white;
        }
     
        .footer__deliverButton {
            background: #0066cc;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
     
        .footer__deliverButton:hover {
            background-color: #0052a3;
        }
        .footer__deliverButton:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }
     
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
     
        /* Highlight color buttons */
        .highlight-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-block;
            margin: 0 2px;
            cursor: pointer;
            border: 1px solid #ccc;
        }
     
        .highlight-color.yellow { background-color: #ffff00; }
        .highlight-color.green { background-color: #00ff00; }
        .highlight-color.pink { background-color: #ff69b4; }
        .highlight-color.blue { background-color: #00bfff; }
        /* Time warning styles */
        .timer-warning {
            color: #ff0000;
            animation: blink 1s infinite;
        }
        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        /* Submission modal styles */
        .submission-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        .submission-content {
            background-color: white;
            width: 80%;
            max-width: 800px;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 5px 30px rgba(0,0,0,0.5);
            max-height: 80vh;
            overflow-y: auto;
        }
        .submission-content h2 {
            margin-top: 0;
            color: #0066cc;
            border-bottom: 2px solid #0066cc;
            padding-bottom: 10px;
        }
        .submission-content p {
            margin-bottom: 20px;
            color: #333;
        }
        .answers-section {
            margin-top: 20px;
        }
        .answers-section h3 {
            color: #0066cc;
            margin-bottom: 15px;
        }
        .answer-item {
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 4px;
            border-left: 4px solid #ddd;
            background-color: #f9f9f9;
        }
        .answer-item.correct {
            border-left-color: #4CAF50;
            background-color: #f0fff0;
        }
        .answer-item.incorrect {
            border-left-color: #f44336;
            background-color: #fff0f0;
        }
        .answer-text {
            font-weight: bold;
        }
        .correct-answer {
            color: #4CAF50;
            margin-left: 10px;
        }
        .incorrect-answer {
            color: #f44336;
            margin-left: 10px;
        }
        .answer-status {
            float: right;
            margin-left: 15px;
        }
        .correct-status {
            color: #4CAF50;
        }
        .incorrect-status {
            color: #f44336;
        }
        .submission-buttons {
            margin-top: 25px;
            text-align: right;
            clear: both;
        }
        .submission-buttons button {
            padding: 8px 15px;
            margin-left: 10px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
        .submission-buttons .confirm {
            background: #0066cc;
            color: white;
            border: none;
        }
        /* Disabled state */
        input:disabled {
            background-color: #f5f5f5;
            cursor: not-allowed;
        }
        /* Score display styles */
        .score-display {
            text-align: center;
            margin-bottom: 20px;
        }
        .score-number {
            font-size: 3rem;
            font-weight: bold;
            color: #0066cc;
            margin: 10px 0;
        }
        .score-total {
            font-size: 1.5rem;
            color: #666;
        }
        .performance-rating {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 15px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .excellent {
            color: #2E7D32;
            background-color: #E8F5E9;
        }
        .very-good {
            color: #388E3C;
            background-color: #E8F5E9;
        }
        .good {
            color: #689F38;
            background-color: #F1F8E9;
        }
        .fair {
            color: #F57C00;
            background-color: #FFF3E0;
        }
        .poor {
            color: #D32F2F;
            background-color: #FFEBEE;
        }
        /* IELTS Band Score */
        .band-score {
            font-size: 2rem;
            font-weight: bold;
            color: #0066cc;
            margin: 10px 0;
        }
        /* Correct answer highlight */
        .correct-highlight {
            background-color: rgba(76, 175, 80, 0.3);
        }
        /* Incorrect answer highlight */
        .incorrect-highlight {
            background-color: rgba(244, 67, 54, 0.3);
        }
        /* Answer comparison section */
        .answer-comparison {
            margin-top: 20px;
            padding: 15px;
            background-color: #f5f5f5;
            border-radius: 5px;
            display: none;
        }
        .answer-comparison h3 {
            margin-top: 0;
            color: #0066cc;
        }
        /* Time spent indicator */
        .time-spent {
            font-size: 1rem;
            color: #666;
            margin-bottom: 15px;
            text-align: center;
        }
        /* Summary completion styles */
        .summary-completion-container {
            margin-top: 20px;
        }
        .summary-text p {
            line-height: 2.5;
            font-size: 16px;
        }
        .summary-drop-zone {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            vertical-align: middle;
            min-width: 150px;
            height: 25px;
            border: 2px dashed #999;
            border-radius: 4px;
            margin: 0 5px;
            padding: 0 5px;
            transition: all 0.3s ease;
            color: #aaa;
            font-weight: bold;
            position: relative;
        }
        .summary-drop-zone.filled {
            border-color: #4a90e2;
            background-color: #e3f2fd;
            color: #333;
            font-weight: bold;
            cursor: pointer;
        }
     
        .summary-drop-zone:hover {
            border-color: #4a90e2;
            background-color: #f0f8ff;
        }
        .summary-drop-zone.active-input {
            border-color: #4a90e2;
            box-shadow: none;
        }
        .summary-drop-zone .drag-item {
            font-size: 15px;
            font-weight: bold;
            background-color: transparent;
            border: none;
            padding: 0;
            text-align: center;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: move;
        }
     
        .summary-drop-zone.correct {
            background-color: #e9f7ef;
            border-color: #28a745;
            border-style: solid;
        }
     
        .summary-drop-zone.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
            border-style: solid;
        }
        .summary-feedback {
            display: inline-block;
            margin-left: 10px;
            font-size: 14px;
        }
        .summary-feedback.correct {
            color: #28a745;
        }
        .summary-feedback.incorrect {
            color: #dc3545;
        }
        .summary-options-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            min-height: 50px;
        }
        .summary-options-bank .drag-item {
            flex-grow: 1;
            min-width: 100px;
            text-align: center;
            padding: 5px 10px;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: move;
            user-select: none;
            transition: all 0.3s ease;
        }
     
        .summary-options-bank .drag-item:hover {
            background-color: #e0e0e0;
            transform: translateY(-2px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
     
        .summary-options-bank .drag-item.dragging {
            opacity: 0.5;
            transform: scale(0.95);
        }
     
        /* New styles for draggable items */
        .drag-item {
            touch-action: none; /* Prevent scrolling while dragging on touch devices */
        }
        .drag-ghost {
            opacity: 0.8;
            transform: rotate(2deg);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .drop-hover {
            background-color: #e3f2fd !important;
            border-color: #4a90e2 !important;
        }
    </style>
</head>
<body>
    <div class="test-wrapper">
        <header class="header">
            <div class="header__logo">
                <a href="https://t.me/SIROJ_NOTES" target="_blank" style="text-decoration: none; color: #0066cc; font-weight: bold; display: inline-flex; align-items: center; gap: 5px;">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69a.2.2 0 0 0-.05-.18c-.06-.05-.14-.03-.21-.02-.09.02-.38.24-1.07.7-.96.66-1.89 1.28-1.89 1.28s-.17.11-.49.03c-.32-.08-.72-.26-1.16-.47-.54-.26-1.17-.53-1.17-.53s-.87-.55.62-1.14c.32-.13 1.96-.84 2.99-1.2 1.05-.37 2.86-1.01 2.86-1.01s1.02-.4 1.02 0z" fill="#0088cc"/>
                    </svg>
                    @SIROJ_NOTES
                </a>
            </div>
            <div class="header__timer" id="testTimer">00:00</div>
            <div class="header__icons">
                <i class="fas fa-wifi header__icon"></i>
                <i class="fas fa-bell header__icon"></i>
                <i class="fas fa-cog header__icon" id="settingsButton"></i>
            </div>
        </header>
     
        <div class="settings-modal" id="settingsModal">
            <div class="settings-content">
                <div class="settings-header">
                    <h2>Options</h2>
                    <button class="settings-close" id="settingsClose">&times;</button>
                </div>
                <div class="settings-body">
                    <div class="settings-option">
                        <i class="fas fa-paper-plane"></i>
                        <span>Go to submission page</span>
                    </div>
                    <div class="settings-option" id="contrastOption">
                        <i class="fas fa-adjust"></i>
                        <span>Contrast</span>
                    </div>
                    <div class="settings-option" id="textSizeOption">
                        <i class="fas fa-search-plus"></i>
                        <span>Text size</span>
                    </div>
                </div>
            </div>
        </div>
     
        <div class="sectionRubric" id="sectionRubric">
            <h2>Reading Passage 3</h2>
            <p>You should spend about 20 minutes on Questions 27-40.</p>
        </div>
     
        <div class="test-container">
            <div class="passage-container" id="passage-container">
                <div class="highlight-toolbar" id="highlightToolbar">
                    <button class="highlight-color yellow" data-color="yellow" title="Yellow highlight"></button>
                    <button class="highlight-color green" data-color="green" title="Green highlight"></button>
                    <button class="highlight-color pink" data-color="pink" title="Pink highlight"></button>
                    <button class="highlight-color blue" data-color="blue" title="Blue highlight"></button>
                    <button class="remove" title="Remove highlight"><i class="fas fa-times"></i></button>
                </div>
             
                <div id="passageContent">
                    <h2 style="text-align: center;">Improving Patient Safety</h2>
                    <p style="text-align: center; font-style: italic;">How improved drug packaging could provide some answers to patient safety issues</p>
                    <h3>Packaging</h3>
                    <p>One of the most prominent design issues in pharmacy is that of drug packages and the patient information leaflets (PILs) included in them. Many pharmacists are concerned that current designs are 'accidents waiting to happen'. The UK government shares this concern and, in 2003, the National Patient Safety Agency created a new role, appointing Colum Lowe, who has 14 years' experience as a designer in the private sector, as head of design and human factors.</p>
                    <p>Packaging design in the pharmaceutical industry is handled by either in-house teams or external design agencies. For packaging design of over-the-counter medicines, which do not have to be dispensed by a pharmacist but can be bought directly from a sales assistant, characteristics such as attractiveness and distinguishability are important and so these are usually commissioned from an external design team. The marketing team prepares the initial brief and the designers come up with six or seven designs. Two or three of these are then tested on a consumer group. In contrast, most designs for prescription-only products are created in-house. In some cases, this may simply involve the company's design team applying the house design and then handing it over to design engineers rather than testing the design on a consumer group. Clearly this process cannot adequately address the needs of the wide variety of patients using medication.</p>
                    <h3>Design considerations</h3>
                    <p>In her book <i>Information Design for Patient Safety</i>, Thea Swayne highlighted a multitude of design problems. For example, drugs that look or sound alike can lead to confusion, small type sizes and even the glare on silver foil packaging can lead to names or instructions being misread. One such example is a drug that was accidentally injected into a patient through the spine (intrathecally) rather than through the veins (intravenously). Investigations following this tragedy attributed some blame to the poor choice of typescript used on the drug container.</p>
                    <p>Furthermore, according to Swayne, real situations in which medicines are used include a parent giving a cough medicine to a child in the middle of the night; packaging should be designed for moments such as these rather than for the ideal world of a hospital.</p>
                    <h3>Safety and compliance</h3>
                    <p>Child protection is another area that gives designers opportunities to improve safety. According to the Child Accident Prevention Trust, 70% of children admitted to hospital with suspected poisoning have swallowed medicines, and although child-resistant lids have helped, they are not yet fully effective. There is scope for improving what is currently available, according to Richard Mawle, a freelance product designer who feels it is not just children who are blocked by child-proof closures. 'Many child-resistant packs are based on strength but older people may have the same level of strength as a child,' he explained, and suggested that better designs could rely on cognitive skills (e.g. removing the lid using a three-step process).</p>
                    <p>Mawle also worked on a project which involved applying his skills to packaging and PILs. Commenting on the information presented, he said: 'There can be an awful lot of junk at the beginning of PILs. For example, why are company details towards the beginning of a leaflet when what might be more vital for the patient is that the medicine should not be taken with alcohol?'</p>
                    <h3>Design principles and guidelines</h3>
                    <p>Most designers work according to basic principles; for example, certain print styles are known to be more difficult to read than others. Look-alike boxes present the potential for errors and an obvious solution would be to use colours to highlight a larger dosage of a drug. However, according to Thea Swayne, designating a colour to a particular dosage is not recommended because this could lead to the user not reading the text on a box.</p>
                    <p>Design features can provide the basis for lengthy debates. One argument is that if all packaging was white with black lettering, people would have no choice but to read every box carefully. The problem is that trials of drug packaging are few - common signage studies concern road traffic signs and visual display units. Although some designers take results from such studies into account, proving that a particular feature is beneficial can be difficult. For example, current UK legislation requires packaging to include the name of the medicine in Braille, but, according to Karel van der Waarde, a design consultant to the pharmaceutical industry, 'it is not known how much visually impaired patients will benefit nor how much the reading of visually able patients will be impaired'. Van der Waarde is sceptical about current legislation and says that many regulatory authorities do not have the resources to handle packaging information properly. 'They do not look at the use of packaging in a practical context - they only see one box at a time and not several together as pharmacists would do,' he said.</p>
                    <h3>Innovation</h3>
                    <p>On a positive note, a recent innovation exhibition revealed several new designs. 'The popper' aims to help arthritis sufferers remove tablets from blister packs, and 'Pluspoint' is an adrenaline auto-injector (a device that allows diabetics to inject themselves) aimed at overcoming the fact that many patients do not carry their medication due to its prohibitive size. The aim of good design is to try to make things more user-friendly as well as safer. The guidelines in <i>Information Design for Patient Safety</i> are not intended to be legally binding. Rather, the book's purpose is to create a basic design standard and to stimulate innovation. The challenge for the pharmaceutical industry is to adopt such a standard.</p>
                </div>
            </div>
         
            <div class="divider" id="divider">
                <div class="divider-handle"></div>
            </div>
         
            <div class="questions-container" id="questions-container">
                <div class="question">
                    <div class="question-rubric">
                        <h3>Questions 27-32</h3>
                        <p>Look at the following statements (Questions 27-32) and the list of people or groups below.</p>
                        <p>Match each statement with the correct person or group, <strong>A, B, C, or D</strong>.</p>
                        <p>Write the correct letter, <strong>A, B, C, or D</strong>.</p>
                    </div>
                 
                    <div class="question-content">
                        <div class="question-item">
                            <p><strong>27</strong> The elderly would benefit from drug containers that do not require force to open them.</p>
                            <ul class="question-options">
                                <li class="mcq-option">
                                    <input type="radio" name="q27" id="q27-a" value="A">
                                    <label for="q27-a">A. Thea Swayne</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q27" id="q27-b" value="B">
                                    <label for="q27-b">B. The Child Accident Prevention Trust</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q27" id="q27-c" value="C">
                                    <label for="q27-c">C. Richard Mawle</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q27" id="q27-d" value="D">
                                    <label for="q27-d">D. Karel van der Waarde</label>
                                </li>
                            </ul>
                        </div>
                     
                        <div class="question-item">
                            <p><strong>28</strong> Adapting packaging for the blind may disadvantage people who can see.</p>
                            <ul class="question-options">
                                <li class="mcq-option">
                                    <input type="radio" name="q28" id="q28-a" value="A">
                                    <label for="q28-a">A. Thea Swayne</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q28" id="q28-b" value="B">
                                    <label for="q28-b">B. The Child Accident Prevention Trust</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q28" id="q28-c" value="C">
                                    <label for="q28-c">C. Richard Mawle</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q28" id="q28-d" value="D">
                                    <label for="q28-d">D. Karel van der Waarde</label>
                                </li>
                            </ul>
                        </div>
                     
                        <div class="question-item">
                            <p><strong>29</strong> Specially designed containers have not been able to eliminate drugs being swallowed accidentally.</p>
                            <ul class="question-options">
                                <li class="mcq-option">
                                    <input type="radio" name="q29" id="q29-a" value="A">
                                    <label for="q29-a">A. Thea Swayne</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q29" id="q29-b" value="B">
                                    <label for="q29-b">B. The Child Accident Prevention Trust</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q29" id="q29-c" value="C">
                                    <label for="q29-c">C. Richard Mawle</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q29" id="q29-d" value="D">
                                    <label for="q29-d">D. Karel van der Waarde</label>
                                </li>
                            </ul>
                        </div>
                     
                        <div class="question-item">
                            <p><strong>30</strong> Designers have to consider how drugs are used in the home.</p>
                            <ul class="question-options">
                                <li class="mcq-option">
                                    <input type="radio" name="q30" id="q30-a" value="A">
                                    <label for="q30-a">A. Thea Swayne</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q30" id="q30-b" value="B">
                                    <label for="q30-b">B. The Child Accident Prevention Trust</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q30" id="q30-c" value="C">
                                    <label for="q30-c">C. Richard Mawle</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q30" id="q30-d" value="D">
                                    <label for="q30-d">D. Karel van der Waarde</label>
                                </li>
                            </ul>
                        </div>
                     
                        <div class="question-item">
                            <p><strong>31</strong> Governing bodies need to compare different drug containers rather than studying individual ones.</p>
                            <ul class="question-options">
                                <li class="mcq-option">
                                    <input type="radio" name="q31" id="q31-a" value="A">
                                    <label for="q31-a">A. Thea Swayne</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q31" id="q31-b" value="B">
                                    <LABEL for="q31-b">B. The Child Accident Prevention Trust</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q31" id="q31-c" value="C">
                                    <label for="q31-c">C. Richard Mawle</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q31" id="q31-d" value="D">
                                    <label for="q31-d">D. Karel van der Waarde</label>
                                </li>
                            </ul>
                        </div>
                     
                        <div class="question-item">
                            <p><strong>32</strong> Information provided with medicine is not listed in the right order.</p>
                            <ul class="question-options">
                                <li class="mcq-option">
                                    <input type="radio" name="q32" id="q32-a" value="A">
                                    <label for="q32-a">A. Thea Swayne</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q32" id="q32-b" value="B">
                                    <label for="q32-b">B. The Child Accident Prevention Trust</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q32" id="q32-c" value="C">
                                    <label for="q32-c">C. Richard Mawle</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q32" id="q32-d" value="D">
                                    <label for="q32-d">D. Karel van der Waarde</label>
                                </li>
                            </ul>
                        </div>
                        <div class="question-rubric">
                            <p><strong>List of People or Groups</strong></p>
                            <ul>
                                <li>A. Thea Swayne</li>
                                <li>B. The Child Accident Prevention Trust</li>
                                <li>C. Richard Mawle</li>
                                <li>D. Karel van der Waarde</li>
                            </ul>
                        </div>
                    </div>
                </div>
             
                <div class="question">
                    <div class="question-rubric">
                        <h3>Questions 33-37</h3>
                        <p>Complete the summary using the list of words, <strong>A-G</strong>, below.</p>
                        <p>Drag and drop the correct words into the gaps.</p>
                    </div>
                 
                    <div class="question-content">
                        <div class="summary-completion-container">
                            <h4 style="text-align: center;">Packaging design in the pharmaceutical industry</h4>
                            <div class="summary-text">
                                <p><strong>Over-the-counter drugs</strong><br>First, a proposal is written by the <span class="summary-drop-zone" data-q-start="33" data-dnd-group="summary-33-37">33</span>. Then several designs are produced by the <span class="summary-drop-zone" data-q-start="34" data-dnd-group="summary-33-37">34</span>. Finally, selected designs are shown to <span class="summary-drop-zone" data-q-start="35" data-dnd-group="summary-33-37">35</span>.</p>
                                <p><strong>Prescription-only drugs</strong><br>The <span class="summary-drop-zone" data-q-start="36" data-dnd-group="summary-33-37">36</span> create the design. The design is then passed to <span class="summary-drop-zone" data-q-start="37" data-dnd-group="summary-33-37">37</span>.</p>
                            </div>
                         
                            <div class="summary-options-bank" id="optionsBank">
                                <div class="drag-item" draggable="true" data-value="A">consumers</div>
                                <div class="drag-item" draggable="true" data-value="B">design engineers</div>
                                <div class="drag-item" draggable="true" data-value="C">external design team</div>
                                <div class="drag-item" draggable="true" data-value="D">in-house design team</div>
                                <div class="drag-item" draggable="true" data-value="E">marketing team</div>
                                <div class="drag-item" draggable="true" data-value="F">pharmaceutical industry</div>
                                <div class="drag-item" draggable="true" data-value="G">pharmacists</div>
                            </div>
                        </div>
                    </div>
                </div>
             
                <div class="question">
                    <div class="question-rubric">
                        <h3>Questions 38-40</h3>
                        <p>Choose the correct letter, <strong>A, B, C, or D</strong>.</p>
                    </div>
                 
                    <div class="question-content">
                        <div class="question-item">
                            <p><strong>38</strong> In the accident mentioned in the passage, what was the 'design consideration' that caused a drug to be given incorrectly?</p>
                            <ul class="question-options">
                                <li class="mcq-option">
                                    <input type="radio" name="q38" id="q38-a" value="A">
                                    <label for="q38-a">A. a printing error</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q38" id="q38-b" value="B">
                                    <label for="q38-b">B. the style of print</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q38" id="q38-c" value="C">
                                    <label for="q38-c">C. an incorrect label</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q38" id="q38-d" value="D">
                                    <label for="q38-d">D. the shape of the bottle</label>
                                </li>
                            </ul>
                        </div>
                     
                        <div class="question-item">
                            <p><strong>39</strong> What do some people say about the use of only black and white as a design feature?</p>
                            <ul class="question-options">
                                <li class="mcq-option">
                                    <input type="radio" name="q39" id="q39-a" value="A">
                                    <label for="q39-a">A. Consumers would dislike this option.</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q39" id="q39-b" value="B">
                                    <label for="q39-b">B. Drug containers would all look too similar.</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q39" id="q39-c" value="C">
                                    <label for="q39-c">C. People would pay more attention to label information.</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q39" id="q39-d" value="D">
                                    <label for="q39-d">D. Partially sighted people would find these colours more helpful.</label>
                                </li>
                            </ul>
                        </div>
                     
                        <div class="question-item">
                            <p><strong>40</strong> Why does the writer refer to 'the popper' and 'Pluspoint'?</p>
                            <ul class="question-options">
                                <li class="mcq-option">
                                    <input type="radio" name="q40" id="q40-a" value="A">
                                    <label for="q40-a">A. to show that progress is being made in pharmaceutical packaging design</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q40" id="q40-b" value="B">
                                    <label for="q40-b">B. to give an example of pharmaceutical design problems that can cause accidents</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q40" id="q40-c" value="C">
                                    <label for="q40-c">C. to prove that a lot of work still needs to be done to improve pharmaceutical packaging design</label>
                                </li>
                                <li class="mcq-option">
                                    <input type="radio" name="q40" id="q40-d" value="D">
                                    <label for="q40-d">D. to point out that patients need to be more informed about pharmaceutical products</label>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
     
        <footer class="footer">
            <nav class="nav-row perScorableItem" aria-label="Questions">
                <div class="footer__questionWrapper selected multiple" role="tablist">
                    <button role="tab" class="footer__questionNo" data-sectionid="128121930" tabindex="-1">
                        <span>
                            <span aria-hidden="true" class="section-prefix">Questions </span>
                            <span class="sectionNr" aria-hidden="true">27-40</span>
                        </span>
                    </button>
                    <div class="footer__subquestionWrapper">
                    </div>
                </div>
                <button id="deliver-button" aria-label="Review your answers" class="footer__deliverButton">
                    <i class="fas fa-check"></i> Submit
                </button>
            </nav>
        </footer>
    </div>
    <div class="submission-modal" id="submissionModal">
        <div class="submission-content">
            <h2 id="submissionTitle">Test Results</h2>
            <div class="score-display">
                <div>Your Score:</div>
                <div class="score-number" id="userScore">0</div>
                <div class="score-total">out of <span id="totalQuestions">14</span></div>
                <div class="band-score" id="bandScore">Band: 0.0</div>
                <div class="performance-rating" id="performanceRating">Poor - Needs Improvement</div>
            </div>
            <div class="time-spent" id="timeSpent"></div>
            <p id="submissionMessage">Here are your answers with the correct solutions:</p>
         
            <div class="answers-section">
                <h3>Your Answers:</h3>
                <div id="answersList"></div>
            </div>
         
            <div class="submission-buttons">
                <button class="confirm" id="closeSubmission">Close & Review</button>
            </div>
        </div>
    </div>
    <div class="answer-comparison" id="answerComparison">
        <h3>Answer Comparison</h3>
        <p>Your answers are highlighted below. Correct answers are marked in <span class="correct-highlight">green</span>.</p>
    </div>
<script>
        document.addEventListener('DOMContentLoaded', function() {
            // Timer functionality - Stopwatch (count up)
            let elapsedSeconds = 0;
            const timerElement = document.getElementById('testTimer');
            let testSubmitted = false;
            let warningShown = false;
            let userAnswers = {};
            let startTime = new Date();
            let resultsShown = false;
            const correctAnswers = {
                27: "C", 28: "D", 29: "B", 30: "A", 31: "D", 32: "C",
                33: "E", 34: "C", 35: "A", 36: "D", 37: "B",
                38: "B", 39: "C", 40: "A"
            };
            const totalQuestions = Object.keys(correctAnswers).length;
            // --- START: DRAG AND DROP LOGIC ---
            let draggedItem = null;
            const dropZones = document.querySelectorAll('.summary-drop-zone');
            const dragItems = document.querySelectorAll('.drag-item');
            const optionsBank = document.getElementById('optionsBank');
            const initialOrder = optionsBank ? Array.from(optionsBank.children).map(el => el.dataset.value || el.id) : [];
         
            dragItems.forEach(item => {
                item.addEventListener('dragstart', function(e) {
                    draggedItem = this;
                    setTimeout(() => this.classList.add('dragging'), 0);
                    e.dataTransfer.setData('text/plain', this.dataset.value);
                    e.dataTransfer.effectAllowed = 'move';
                });
             
                item.addEventListener('dragend', () => {
                    if (draggedItem) {
                        draggedItem.classList.remove('dragging');
                        draggedItem = null;
                    }
                });
            });
         
            const handleDropOnZone = (zone, e) => {
                e.preventDefault();
                zone.classList.remove('drop-hover');
                if (!draggedItem) return;
                const originalParent = draggedItem.parentElement;
                if (zone.querySelector('.drag-item')) {
                    const existingItem = zone.querySelector('.drag-item');
                    originalParent.appendChild(existingItem);
                } else if (originalParent.classList.contains('summary-drop-zone')) {
                    originalParent.innerHTML = originalParent.dataset.qStart;
                    originalParent.classList.remove('filled');
                    const originalQButton = document.querySelector(`.subQuestion[data-ordernumber="${originalParent.dataset.qStart}"]`);
                    if (originalQButton) originalQButton.classList.remove('attempted');
                }
             
                zone.innerHTML = '';
                zone.appendChild(draggedItem);
                zone.classList.add('filled');
                const questionNumber = zone.dataset.qStart;
                const questionButton = document.querySelector(`.subQuestion[data-ordernumber="${questionNumber}"]`);
                if (questionButton) questionButton.classList.add('attempted');
            };
         
            dropZones.forEach(zone => {
                zone.addEventListener('dragenter', e => { e.preventDefault(); zone.classList.add('drop-hover'); });
                zone.addEventListener('dragleave', () => zone.classList.remove('drop-hover'));
                zone.addEventListener('dragover', e => { e.preventDefault(); e.dataTransfer.dropEffect = 'move'; });
                zone.addEventListener('drop', e => handleDropOnZone(zone, e));
            });
         
            const handleDropOnBank = (bank, e) => {
                e.preventDefault();
                bank.classList.remove('drop-hover');
                if (!draggedItem) return;
                const originalParent = draggedItem.parentElement;
                if (originalParent.classList.contains('summary-drop-zone')) {
                    originalParent.innerHTML = originalParent.dataset.qStart;
                    originalParent.classList.remove('filled');
                    const questionButton = document.querySelector(`.subQuestion[data-ordernumber="${originalParent.dataset.qStart}"]`);
                    if (questionButton) questionButton.classList.remove('attempted');
                }
             
                // insert draggedItem at its original order position
                if (initialOrder && initialOrder.length) {
                    const idx = initialOrder.indexOf(draggedItem.dataset.value || draggedItem.id);
                    const siblings = Array.from(bank.children);
                    let inserted = false;
                    for (let s of siblings) {
                        const sIdx = initialOrder.indexOf(s.dataset.value || s.id);
                        if (sIdx > idx) {
                            bank.insertBefore(draggedItem, s);
                            inserted = true;
                            break;
                        }
                    }
                    if (!inserted) bank.appendChild(draggedItem);
                } else {
                    bank.appendChild(draggedItem);
                }
            };
            optionsBank.addEventListener('dragenter', e => { e.preventDefault(); optionsBank.classList.add('drop-hover'); });
            optionsBank.addEventListener('dragleave', () => optionsBank.classList.remove('drop-hover'));
            optionsBank.addEventListener('dragover', e => { e.preventDefault(); e.dataTransfer.dropEffect = 'move'; });
            optionsBank.addEventListener('drop', e => handleDropOnBank(optionsBank, e));
            // --- END: DRAG AND DROP LOGIC ---
            function updateTimer() {
                if (testSubmitted) return;
                const minutes = Math.floor(elapsedSeconds / 60);
                const seconds = elapsedSeconds % 60;
                timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
             
                if (elapsedSeconds >= 1200 && !warningShown) { // 20 minute warning
                    timerElement.classList.add('timer-warning');
                    warningShown = true;
                }
                elapsedSeconds++;
            }
            function disableAllInputs() {
                document.querySelectorAll('input[type="radio"]').forEach(input => input.disabled = true);
                document.getElementById('deliver-button').disabled = true;
                document.removeEventListener('mouseup', handleTextSelection);
             
                document.querySelectorAll('.drag-item').forEach(item => item.draggable = false);
            }
         
            function showSubmissionModal(title, message) {
                const modal = document.getElementById('submissionModal');
                document.getElementById('submissionTitle').textContent = title;
                document.getElementById('submissionMessage').textContent = message;
             
                const endTime = new Date();
                const timeDiff = endTime - startTime;
                const minutes = Math.floor(timeDiff / 60000);
                const seconds = Math.floor((timeDiff % 60000) / 1000);
                document.getElementById('timeSpent').textContent = `Time spent: ${minutes}m ${seconds}s`;
             
                const answersList = document.getElementById('answersList');
                answersList.innerHTML = '';
             
                let score = 0;
                userAnswers = {};
             
                for (let i = 27; i <= 40; i++) {
                    let userAnswer, userAnswerText = '', correctAnswer, isCorrect;
                    const answerItem = document.createElement('div');
                 
                    if (i >= 33 && i <= 37) { // Summary Completion
                        const dropZone = document.querySelector(`.summary-drop-zone[data-q-start="${i}"]`);
                        const droppedItem = dropZone ? dropZone.querySelector('.drag-item') : null;
                        userAnswer = droppedItem ? droppedItem.dataset.value : 'Not answered';
                        userAnswerText = droppedItem ? ` - ${droppedItem.textContent}` : '';
                    } else { // Matching and MCQ
                        const selectedOption = document.querySelector(`input[name="q${i}"]:checked`);
                        userAnswer = selectedOption ? selectedOption.value : 'Not answered';
                        if (i <= 32) { // For matching questions, get the text of the selected option
                            const label = selectedOption ? selectedOption.nextElementSibling.textContent : '';
                            userAnswerText = userAnswer !== 'Not answered' ? ` - ${label}` : '';
                        }
                    }
                 
                    userAnswers[i] = userAnswer;
                    correctAnswer = correctAnswers[i];
                    isCorrect = userAnswer === correctAnswer;
                 
                    if (isCorrect) score++;
                    let correctAnswerText = '';
                    if (i >= 33 && i <= 37) { // Summary Completion
                        const correctDragItem = document.querySelector(`.drag-item[data-value="${correctAnswer}"]`);
                        correctAnswerText = correctDragItem ? ` - ${correctDragItem.textContent}` : '';
                    } else if (i <= 32) { // Matching
                        const correctOptionEl = document.querySelector(`input[name="q${i}"][value="${correctAnswer}"]`);
                        correctAnswerText = correctOptionEl ? ` - ${correctOptionEl.nextElementSibling.textContent}` : '';
                    } else { // MCQ
                        const correctOptionEl = document.querySelector(`input[name="q${i}"][value="${correctAnswer}"]`);
                        correctAnswerText = correctOptionEl ? ` - ${correctOptionEl.nextElementSibling.textContent}` : '';
                    }
                 
                    answerItem.className = `answer-item ${isCorrect ? 'correct' : 'incorrect'}`;
                    answerItem.innerHTML = `
                        <div class="answer-text">Question ${i}: ${userAnswer}${userAnswerText}</div>
                        <span class="${isCorrect ? 'correct-answer' : 'incorrect-answer'}">(Correct: ${correctAnswer}${correctAnswerText})</span>
                        <span class="answer-status ${isCorrect ? 'correct-status' : 'incorrect-status'}">${isCorrect ? '' : ''}</span>
                    `;
                    answersList.appendChild(answerItem);
                }
             
                document.getElementById('userScore').textContent = score;
                document.getElementById('totalQuestions').textContent = totalQuestions;
             
                const bandScore = calculateBandScore(score);
                document.getElementById('bandScore').textContent = `Band: ${bandScore.toFixed(1)}`;
             
                let rating, ratingClass;
                if (score >= 13) { rating = "Excellent!"; ratingClass = "excellent"; }
                else if (score >= 11) { rating = "Very Good"; ratingClass = "very-good"; }
                else if (score >= 9) { rating = "Good"; ratingClass = "good"; }
                else if (score >= 7) { rating = "Fair"; ratingClass = "fair"; }
                else { rating = "Poor - Needs Improvement"; ratingClass = "poor"; }
             
                const ratingElement = document.getElementById('performanceRating');
                ratingElement.textContent = rating;
                ratingElement.className = `performance-rating ${ratingClass}`;
             
                modal.style.display = 'flex';
                resultsShown = true;
             
                const submitButton = document.getElementById('deliver-button');
                submitButton.innerHTML = '<i class="fas fa-eye"></i> Show My Results';
                submitButton.disabled = false;
            }
            function calculateBandScore(score) {
                if (score >= 14) return 9.0;
                if (score >= 13) return 8.5;
                if (score >= 12) return 8.0;
                if (score >= 11) return 7.5;
                if (score >= 10) return 7.0;
                if (score >= 9) return 6.5;
                if (score >= 8) return 6.0;
                if (score >= 7) return 5.5;
                if (score >= 6) return 5.0;
                if (score >= 5) return 4.5;
                return 4.0;
            }
            function highlightAnswers() {
                for (let i = 33; i <= 37; i++) {
                    const dropZone = document.querySelector(`.summary-drop-zone[data-q-start="${i}"]`);
                    if (dropZone) {
                        const userAnswer = userAnswers[i];
                        const isCorrect = userAnswer === correctAnswers[i];
                     
                        const existingFeedback = dropZone.nextElementSibling;
                        if (existingFeedback && existingFeedback.classList.contains('summary-feedback')) existingFeedback.remove();
                        if (userAnswer !== 'Not answered') {
                            dropZone.classList.add(isCorrect ? 'correct' : 'incorrect');
                            if (!isCorrect) {
                                const correctDragItem = document.querySelector(`.drag-item[data-value="${correctAnswers[i]}"]`);
                                const correctText = correctDragItem ? correctDragItem.textContent : correctAnswers[i];
                                const feedback = document.createElement('span');
                                feedback.className = `summary-feedback incorrect`;
                                feedback.textContent = ` Correct: ${correctText}`;
                                dropZone.parentNode.insertBefore(feedback, dropZone.nextSibling);
                            }
                        }
                    }
                }
                for (let i = 27; i <= 32; i++) {
                    const userAnswer = userAnswers[i];
                    const correctAnswer = correctAnswers[i];
                 
                    const userOptionEl = document.querySelector(`input[name="q${i}"][value="${userAnswer}"]`);
                    if (userOptionEl && userAnswer !== correctAnswer) {
                        userOptionEl.closest('li').classList.add('incorrect-highlight');
                    }
                 
                    const correctOptionEl = document.querySelector(`input[name="q${i}"][value="${correctAnswer}"]`);
                    if (correctOptionEl) {
                        correctOptionEl.closest('li').classList.add('correct-highlight');
                    }
                }
                for (let i = 38; i <= 40; i++) {
                    const userAnswer = userAnswers[i];
                    const correctAnswer = correctAnswers[i];
                 
                    const userOptionEl = document.querySelector(`input[name="q${i}"][value="${userAnswer}"]`);
                    if (userOptionEl && userAnswer !== correctAnswer) {
                        userOptionEl.closest('li').classList.add('incorrect-highlight');
                    }
                 
                    const correctOptionEl = document.querySelector(`input[name="q${i}"][value="${correctAnswer}"]`);
                    if (correctOptionEl) {
                        correctOptionEl.closest('li').classList.add('correct-highlight');
                    }
                }
             
                document.getElementById('answerComparison').style.display = 'block';
            }
         
            document.getElementById('deliver-button').addEventListener('click', function() {
                if (resultsShown) {
                    document.getElementById('submissionModal').style.display = 'flex';
                    return;
                }
                if (confirm('Are you sure you want to submit your test?')) {
                    clearInterval(timerInterval);
                    testSubmitted = true;
                    disableAllInputs();
                    showSubmissionModal('Test Submitted', 'Thank you for completing the test.');
                }
            });
         
            document.getElementById('closeSubmission').addEventListener('click', function() {
                document.getElementById('submissionModal').style.display = 'none';
                highlightAnswers();
            });
         
            const timerInterval = setInterval(updateTimer, 1000);
         
            const settingsButton = document.getElementById('settingsButton');
            const settingsModal = document.getElementById('settingsModal');
            const settingsClose = document.getElementById('settingsClose');
            settingsButton.addEventListener('click', () => settingsModal.style.display = 'flex');
            settingsClose.addEventListener('click', () => settingsModal.style.display = 'none');
         
            const divider = document.getElementById('divider');
            const passageContainer = document.getElementById('passage-container');
            let isDragging = false;
            divider.addEventListener('mousedown', (e) => {
                isDragging = true;
                document.body.style.cursor = 'col-resize';
                const startX = e.clientX;
                const startPassageWidth = passageContainer.offsetWidth;
             
                function onMouseMove(e) {
                    if (!isDragging) return;
                    const newWidth = startPassageWidth + e.clientX - startX;
                    const containerWidth = document.querySelector('.test-container').offsetWidth;
                    if (newWidth > containerWidth * 0.2 && newWidth < containerWidth * 0.8) {
                       passageContainer.style.width = `${newWidth}px`;
                    }
                }
             
                function onMouseUp() {
                    isDragging = false;
                    document.body.style.cursor = '';
                    document.removeEventListener('mousemove', onMouseMove);
                    document.removeEventListener('mouseup', onMouseUp);
                }
             
                document.addEventListener('mousemove', onMouseMove);
                document.addEventListener('mouseup', onMouseUp);
            });
         
            const subQuestionWrapper = document.querySelector('.footer__subquestionWrapper');
            for (let i = 27; i <= 40; i++) {
                const button = document.createElement('button');
                button.className = 'subQuestion';
                button.dataset.ordernumber = i;
                button.innerHTML = `<span class="sr-only">Question ${i}</span><span aria-hidden="true">${i}</span>`;
                subQuestionWrapper.appendChild(button);
            }
            document.querySelectorAll('.subQuestion').forEach(button => {
                button.addEventListener('click', function() {
                    document.querySelectorAll('.subQuestion.active').forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                 
                    const qNum = parseInt(this.dataset.ordernumber);
                    let targetBlock;
                    if (qNum <= 32) targetBlock = 0;
                    else if (qNum <= 37) targetBlock = 1;
                    else targetBlock = 2;
                 
                    document.querySelectorAll('.question')[targetBlock].scrollIntoView({ behavior: 'smooth', block: 'start' });
                });
            });
         
            const highlightToolbar = document.getElementById('highlightToolbar');
            function handleTextSelection(e) {
                if (testSubmitted) return;
                if (highlightToolbar.contains(e.target)) return;
                const selection = window.getSelection();
                const selectedText = selection.toString().trim();
             
                if (selectedText.length > 0) {
                    const range = selection.getRangeAt(0);
                    const contentAreas = document.querySelectorAll('#passageContent, .question-content');
                    if (!Array.from(contentAreas).some(area => area.contains(range.commonAncestorContainer))) {
                        highlightToolbar.style.display = 'none';
                        return;
                    }
                    const rangeRect = range.getBoundingClientRect();
                    highlightToolbar.style.display = 'flex';
                    highlightToolbar.style.top = `${rangeRect.top + window.scrollY - 40}px`;
                    highlightToolbar.style.left = `${rangeRect.left + window.scrollX + (rangeRect.width / 2)}px`;
                } else {
                    highlightToolbar.style.display = 'none';
                }
            }
            document.addEventListener('mouseup', handleTextSelection);
            document.addEventListener('mousedown', (e) => {
                if (!highlightToolbar.contains(e.target) && window.getSelection().toString().length === 0) {
                     highlightToolbar.style.display = 'none';
                }
            });
         
            document.querySelectorAll('.highlight-color').forEach(button => {
                button.addEventListener('click', () => applyHighlight(button.dataset.color));
            });
            document.querySelector('.highlight-toolbar .remove').addEventListener('click', () => removeHighlight());
            function applyHighlight(color) {
                const selection = window.getSelection();
                if (selection.rangeCount > 0) {
                    const range = selection.getRangeAt(0);
                    const span = document.createElement('span');
                    span.className = `highlight ${color}`;
                    try {
                        range.surroundContents(span);
                    } catch (e) {
                        console.error("Highlighting error:", e);
                    }
                    selection.removeAllRanges();
                    highlightToolbar.style.display = 'none';
                }
            }
            function removeHighlight() {
                 const selection = window.getSelection();
                if (selection.rangeCount > 0) {
                    const range = selection.getRangeAt(0);
                    const container = range.commonAncestorContainer;
                    if (container.nodeType === Node.ELEMENT_NODE && container.classList.contains('highlight')) {
                        const parent = container.parentNode;
                        while (container.firstChild) {
                            parent.insertBefore(container.firstChild, container);
                        }
                        parent.removeChild(container);
                    }
                    selection.removeAllRanges();
                    highlightToolbar.style.display = 'none';
                }
            }
         
            document.querySelectorAll('input[type="radio"]').forEach(input => {
                input.addEventListener('change', function() {
                    const questionNumber = this.name.replace('q', '');
                    const questionButton = document.querySelector(`.subQuestion[data-ordernumber="${questionNumber}"]`);
                    if (questionButton) questionButton.classList.add('attempted');
                });
            });
        });
    </script>

<script>
// Store initial order of options in the bank
const bank = document.getElementById('optionsBank');
if (bank) {
  const initialOrder = Array.from(bank.children).map(el => el.id);

  function restoreBankOrder() {
    const currentItems = Array.from(bank.children);
    // Sort current items according to initialOrder
    currentItems.sort((a, b) => {
      return initialOrder.indexOf(a.id) - initialOrder.indexOf(b.id);
    });
    currentItems.forEach(el => bank.appendChild(el));
  }

  // When an item is dropped back into the bank, restore order
  bank.addEventListener('drop', function() {
    setTimeout(restoreBankOrder, 0);
  });
}
</script>

</body>
</html>