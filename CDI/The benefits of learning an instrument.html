<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Full Reading Practice</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #ffffff;
            line-height: 1.4;
            font-size: 16px;
        }

        .header {
            background-color: #ffffff;
            padding: 12px 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            height: 60px;
        }

        .timer-container {
            display: flex;
            position: relative;
            cursor: default;
            color: #333;
            font-size: 16px;
            font-weight: 500;
            align-items: center;
        }

        .timer-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 15px;
        }

        .timer-controls button {
            background: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 50%;
            padding: 0;
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }

        .timer-controls button:hover {
            background: #e0e0e0;
        }

        .telegram-link {
            color: #0088cc;
            text-decoration: none;
            font-weight: 600;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .telegram-link:hover {
            text-decoration: underline;
        }

        .telegram-link::before {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            background-color: currentColor;
            -webkit-mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-1.37.2-1.64l16.56-6.4c.75-.29 1.4.22 1.2.94l-2.67 12.61c-.22.95-1.13 1.18-1.78.73l-4.5-3.32l-2.23 2.15c-.47.44-1.29.21-1.48-.37z"/></svg>');
            mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-1.37.2-1.64l16.56-6.4c.75-.29 1.4.22 1.2.94l-2.67 12.61c-.22.95-1.13 1.18-1.78.73l-4.5-3.32l-2.23 2.15c-.47.44-1.29.21-1.48-.37z"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
        }

        .main-container {
            margin-top: 60px;
            display: flex;
            flex-direction: column;
            background: #ffffff;
            height: calc(100vh - 60px);
        }

        .panels-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .passage-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px;
        }

        .text-center {
            text-align: center;
        }
       
        .reading-passage h4.text-center {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
        }
       
        .reading-passage p {
            margin-bottom: 1.2em;
        }

        .questions-panel {
            flex: 1;
            padding: 20px 20px 100px;
            overflow-y: auto;
            min-width: 200px;
            border-left: 1px solid #e0e0e0;
        }

        .resizer {
            width: 10px;
            cursor: col-resize;
            background-color: #f0f0f0;
            background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" width="10" height="30" viewBox="0 0 10 30"><path d="M4 11h2v2H4zM4 15h2v2H4zM4 19h2v2H4z" fill="%23888"/></svg>');
            background-repeat: no-repeat;
            background-position: center;
            flex-shrink: 0;
            flex-grow: 0;
        }

        .part-header {
            background-color: #f1f2ec;
            padding: 15px 20px;
            border: 1px solid #e0e0e0;
            text-align: left;
            margin: 10px 20px;
            border-radius: 5px;
        }

        .part-header p {
            margin: 0;
        }

        .part-header p:first-child {
            margin-bottom: 5px;
        }

        .question {
            margin-bottom: 40px;
        }

        .question-prompt {
            margin-bottom: 20px;
        }

        .answer-input {
            border: 1px solid #888;
            border-radius: 4px;
            background-color: #fff;
            padding: 2px 5px;
            font-size: 16px;
            text-align: center;
            margin-right: 4px;
            margin-left: 4px;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        .answer-input.correct {
            border-color: #28a745;
            background-color: #e9f7ef;
        }

        .answer-input.incorrect {
            border-color: #dc3545;
            background-color: #f8d7da;
            color: #721c24;
        }

        .matching-question-container {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }

        .matching-options-bank {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .matching-questions {
            flex: 1.5;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .matching-question-item {
            display: flex;
            align-items: center;
            gap: 15px;
            border: 2px solid transparent;
            border-radius: 4px;
            transition: border-color 0.3s;
            padding: 10px;
        }

        .matching-question-item.correct {
            background-color: #e9f7ef;
            border-color: #28a745 !important;
        }

        .matching-question-item.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545 !important;
        }

        .matching-question-item .drop-zone {
            width: 200px;
            flex-shrink: 0;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #aaa;
            border: 2px dashed #aaa;
            border-radius: 4px;
            height: 40px;
            transition: background-color 0.2s, border-color 0.2s;
        }

        .matching-question-item .drop-zone.correct {
            background-color: #e9f7ef;
            border-color: #28a745;
            border-style: solid;
        }

        .matching-question-item .drop-zone.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
            border-style: solid;
        }

        .drag-item {
            background: white;
            border: 1px solid #ddd;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: move;
            font-size: 16px;
            transition: all 0.2s;
            user-select: none;
        }

        .drag-item:hover {
            background: #e9ecef;
        }

        .drag-item.dragging {
            opacity: 0.5;
        }

        .drop-zone.drag-over {
            background-color: #e6f4ff;
            border-color: #4a90e2;
        }

        .paragraph-matching-question {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            margin-bottom: 12px;
            padding: 10px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }

        .paragraph-matching-question.correct {
            background-color: #e9f7ef;
        }

        .paragraph-matching-question.incorrect {
            background-color: #f8d7da;
        }

        .example-box {
            border: 1px solid #ddd;
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .summary-text p {
            line-height: 2.5;
            font-size: 16px;
        }

        .nav-arrows {
            position: fixed;
            bottom: 100px;
            right: 20px;
            display: flex;
            gap: 5px;
            z-index: 101;
        }

        .nav-arrow {
            width: 50px;
            height: 50px;
            background: #333;
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            font-weight: bold;
        }

        .nav-arrow:hover {
            background: #555;
        }

        .nav-arrow:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .nav-row {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #ffffff;
            padding: 0;
            display: flex;
            align-items: center;
            height: 80px;
            z-index: 100;
            border-top: 1px solid #e0e0e0;
        }

        .footer__questionWrapper {
            display: flex;
            align-items: center;
            margin-right: 20px;
        }

        .footer__questionNo {
            background: none;
            border: none;
            padding: 10px 15px;
            font-size: 16px;
            font-weight: 600;
            color: #333;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: background-color 0.2s;
        }

        .footer__questionNo:hover {
            background-color: #f8f9fa;
        }

        .footer__subquestionWrapper {
            display: none;
            gap: 2px;
            margin-left: 10px;
        }

        .footer__questionWrapper.selected .footer__subquestionWrapper {
            display: flex;
        }

        .subQuestion {
            width: 32px;
            height: 32px;
            border: 1px solid #ccc;
            background: white;
            color: #333;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            border-radius: 2px;
        }

        .subQuestion.answered {
            background-color: #e9ecef;
            border-color: #ddd;
        }

        .subQuestion.correct {
            background-color: #28a745;
            color: white;
            border-color: #28a745;
        }

        .subQuestion.incorrect {
            background-color: #dc3545;
            color: white;
            border-color: #dc3545;
        }

        .subQuestion:hover {
            background-color: #f0f0f0;
            border-color: #999;
        }

        .subQuestion.active {
            background-color: #4a90e2;
            color: white;
            border-color: #4a90e2;
        }

        .footer__deliverButton {
            margin-left: auto;
            margin-right: 20px;
            background-color: #0066cc;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s;
            min-width: 170px;
            justify-content: center;
        }

        .footer__deliverButton:hover {
            background-color: #0055aa;
        }

        .footer__deliverButton:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-overlay.hidden {
            display: none;
        }

        .modal-content {
            background: white;
            padding: 25px;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .modal-close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #888;
        }

        .modal-content h2 {
            text-align: center;
            margin-bottom: 15px;
            color: #333;
        }

        .results-summary {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
        }

        .results-details-container {
            overflow-y: auto;
            padding-right: 10px;
        }

        .result-row {
            display: grid;
            grid-template-columns: 40px 1fr 1fr;
            gap: 15px;
            padding: 8px 5px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 15px;
        }

        .result-row.incorrect {
            background-color: #f8d7da;
        }

        .result-row .q-num {
            font-weight: bold;
        }

        .result-row .user-ans {
            color: #555;
        }

        .result-row .correct-ans {
            color: #155724;
            font-weight: 500;
        }

        .hidden {
            display: none !important;
        }

        /* Highlight System Styles */
        .highlight-toolbar {
            position: fixed;
            background: white;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 10000;
            display: none;
            padding: 5px;
            gap: 5px;
            align-items: center;
        }

        .highlight-btn {
            width: 30px;
            height: 30px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.2s;
        }

        .highlight-btn:hover {
            transform: scale(1.1);
        }

        .highlight-btn.yellow {
            background-color: #ffeb3b;
        }

        .highlight-btn.blue {
            background-color: #2196f3;
            color: white;
        }

        .highlight-btn.clear {
            background-color: #f44336;
            color: white;
            font-size: 12px;
        }

        .highlight-yellow {
            background-color: rgba(255, 235, 59, 0.3);
            padding: 1px 2px;
            border-radius: 2px;
        }

        .highlight-blue {
            background-color: rgba(33, 150, 243, 0.3);
            padding: 1px 2px;
            border-radius: 2px;
        }

        .highlight-yellow, .highlight-blue {
            cursor: pointer;
        }

        .highlight-yellow:hover, .highlight-blue:hover {
            opacity: 0.8;
        }

        .yes-no-options {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }

        .yes-no-option {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .multiple-choice-container {
            display: flex;
            flex-direction: column;
            gap: 25px;
            margin-top: 15px;
        }

        .multiple-choice-question {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            background-color: #fafafa;
        }

        .multiple-choice-prompt {
            font-weight: 600;
            margin-bottom: 12px;
            font-size: 16px;
            color: #333;
        }

        .multiple-choice-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .multiple-choice-option {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px;
            border-radius: 4px;
            transition: background-color 0.2s;
            cursor: pointer;
        }

        .multiple-choice-option:hover {
            background-color: #f0f0f0;
        }

        .multiple-choice-option input[type="radio"] {
            width: 18px;
            height: 18px;
            margin-top: 2px;
            flex-shrink: 0;
        }

        .multiple-choice-option label {
            cursor: pointer;
            line-height: 1.4;
        }

        .multiple-choice-option.correct {
            background-color: #e9f7ef;
            border-left: 4px solid #28a745;
        }

        .multiple-choice-option.incorrect {
            background-color: #f8d7da;
            border-left: 4px solid #dc3545;
        }

        .sentence-completion-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 15px;
        }

        .sentence-completion-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
    </style>
</head>
<body>
    <!-- Highlight Toolbar -->
    <div id="highlight-toolbar" class="highlight-toolbar">
        <button class="highlight-btn yellow" title="Yellow Highlight" onclick="applyHighlight('yellow')">Y</button>
        <button class="highlight-btn blue" title="Blue Highlight" onclick="applyHighlight('blue')">B</button>
        <button class="highlight-btn clear" title="Clear Highlight" onclick="clearHighlight()">×</button>
    </div>

    <div class="header">
        <div class="timer-container">
            <span class="timer-display">20:00</span>
            <div class="timer-controls">
                <button id="timer-toggle-btn" title="Pause/Resume Timer">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M8 5v14l11-7L8 5z"/></svg>
                </button>
                <button id="timer-reset-btn" title="Reset Timer">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8s-3.58-8-8-8z"/></svg>
                </button>
            </div>
        </div>
        <a href="tg://resolve?domain=aftum_8" class="telegram-link">
            aftum_8
        </a>
    </div>

    <div class="main-container" id="main-container">
        <div id="passage-header-container">
            <div id="part-header-3" class="part-header">
                <p><strong>Reading Passage 3</strong></p>
                <p>You should spend about 20 minutes on <strong>Questions 27-40</strong>, which are based on Reading Passage 3.</p>
            </div>
        </div>
        <div class="panels-container">
            <div class="passage-panel" id="passage-panel">
                <div id="passage-text-3" class="reading-passage">
                    <h4 class="text-center">The benefits of learning an instrument</h4>
                    <p style="font-style: italic; text-align: center;">Studies show that learning a musical instrument can bring about significant improvements in your brain</p>
                    <p>Are music lessons the way to get smarter? That's what a lot of parents and experts believe: studying an instrument gives children an advantage in the development of their intellectual, perceptual, and cognitive skills. This may, however, turn out to be wishful thinking. Two highly convincing trials carried out recently have found no evidence to support this idea; the IQs of pre-school children who attended several weeks of music classes as part of these studies did not differ significantly from the IQs of those who had not.</p>
                    <p>But that does not mean that the advantages of learning to play music are limited to expressing yourself, impressing friends, or just having fun. A growing number of studies show that learning an instrument in childhood can do something perhaps more valuable for the brain: it can provide benefits as we age, in the form of an added defense against memory loss, cognitive decline, and impaired hearing. Not only that, you may well get those benefits even if you haven't picked up your instrument in years, or decide to take up music for the first time in mid-life or beyond. According to neuropsychologist Brenda Hanna-Pladdy of Emory University in Atlanta, the time spent learning and practicing specific types of motor control and coordination - each finger on each hand doing something different, and for wind and brass instruments, also using your mouth and breathing-contributes to the brain boost that shows up later in life.</p>
                    <p>You can even map the impact of musical training on the brain itself. In one study, Harvard neurologist Gottfried Schlaug found that the brains of adult professional musicians had a larger volume of grey matter than the brains of non-musicians had. Schlaug and colleagues also found that after 15 months of musical training in early childhood, structural brain changes associated with motor and auditory Improvements begin to appear. 'What's unique about playing an instrument is that it requires a wide array of brain regions and cognitive functions to work together simultaneously, in both right and left hemispheres of the brain,' says Alison Balbag of the University of Southern California. 'Playing music may be an efficient way to stimulate the brain', she says, 'cutting across a broad swath of its regions and cognitive functions and with ripple effects through the decades.'</p>
                    <p>More research is showing this might well be the case. In her first study on the subject, Hanna- Pladdy divided 70 healthy adults between the ages of 60 and 83 into three groups: musicians who had studied an instrument for at least ten years, those who had played between one and nine years, and a control group who had never learned an instrument. The group who had studied for at least ten years scored the highest when tested in such areas as nonverbal and visuo-spatial memory, naming objects, and taking in and adapting new information. Her follow-up study a year later confirmed those findings and further suggested that starting musical training before the age of nine and keeping at it for ten years or more may yield the greatest benefits. Interestingly, it was the group who had the lowest level of general education which showed the greatest gap in scores between those who had studied an instrument in childhood and those who had not. Hanna- Pladdy suspects that musical training could have made up for the lack of cognitive stimulation these people had.</p>
                    <p>Neuroscientist Nina Kraus of Northwestern University in Chicago has found still more positive effects of early musical training. She measured the electrical activity in the auditory brainstem of adults, aged 55 to 70, as they responded to the synthesized speech syllable "da." Although none of the subjects had played a musical instrument in 40 years, those who had trained the longest - between four and fourteen years - responded the fastest. "That's significant," says Kraus, "because hearing tends to decline as we age, including the ability to quickly and accurately discern consonants, a skill crucial to understanding and participating in conversation. If your nervous system is not keeping up with the timing necessary for encoding consonants, you will lose out on the flow and meaning of the conversation, and that can potentially create a downward spiral leading to a sense of social isolation," says Kraus. In addition, the fact that musical training appears to enhance auditory working memory might help reinforce in later life the memory capacity that facilitates verbal interaction."</p>
                    <p>In another study at the University of South Florida, assistant professor of music education Jennifer Bugos studied the impact of elementary piano instruction on adults between the ages of 60 and 85. After six months, those who had received piano lessons showed more robust gains in memory, verbal fluency, the speed at which they processed information, planning ability, and other cognitive functions compared with those who had not received the lessons. Bugos believes that playing an instrument has beneficial effects, regardless of how old the person is when he or she begins. "Musical training contains all the components of a cognitive training program that sometimes are overlooked," she says. "And just as we work out our bodies, we should work out our minds."</p>
                </div>
            </div>
            <div class="resizer" id="resizer"></div>
            <div class="questions-panel" id="questions-panel">
                <div id="questions-3" class="question-set">
                    <div class="questions-container">
                        <div class="question" data-q-start="27" data-q-end="30">
                            <div class="question-prompt">
                                <p><strong>Questions 27-30</strong><br>Do the following statements agree with the claims of the writer in Reading Passage 3?</p>
                                <p>In boxes 27-30 on your answer sheet, write</p>
                                <div class="example-box">
                                    <p><strong>YES</strong> if the statement agrees with the claims of the writer</p>
                                    <p><strong>NO</strong> if the statement contradicts the claims of the writer</p>
                                    <p><strong>NOT GIVEN</strong> if it is impossible to say what the writer thinks about this</p>
                                </div>
                            </div>
                            <div class="paragraph-matching-question">
                                <span><strong>27</strong>&nbsp;&nbsp;Many parents indicate that their children struggle to learn a musical instrument.</span>
                                <select class="answer-input" id="q27"><option value=""></option><option value="YES">YES</option><option value="NO">NO</option><option value="NOT GIVEN">NOT GIVEN</option></select>
                            </div>
                            <div class="paragraph-matching-question">
                                <span><strong>28</strong>&nbsp;&nbsp;The findings of the recent research into pre-school children's IQs are unreliable.</span>
                                <select class="answer-input" id="q28"><option value=""></option><option value="YES">YES</option><option value="NO">NO</option><option value="NOT GIVEN">NOT GIVEN</option></select>
                            </div>
                            <div class="paragraph-matching-question">
                                <span><strong>29</strong>&nbsp;&nbsp;The main reasons people take up an instrument are that they enjoy playing music and being creative.</span>
                                <select class="answer-input" id="q29"><option value=""></option><option value="YES">YES</option><option value="NO">NO</option><option value="NOT GIVEN">NOT GIVEN</option></select>
                            </div>
                            <div class="paragraph-matching-question">
                                <span><strong>30</strong>&nbsp;&nbsp;Evidence about the long-term advantages of learning an instrument is increasing.</span>
                                <select class="answer-input" id="q30"><option value=""></option><option value="YES">YES</option><option value="NO">NO</option><option value="NOT GIVEN">NOT GIVEN</option></select>
                            </div>
                        </div>
                        <div class="question" data-q-start="31" data-q-end="35">
                            <div class="question-prompt">
                                <p><strong>Questions 31-35</strong><br>Choose the correct letter, <strong>A</strong>, <strong>B</strong>, <strong>C</strong> or <strong>D</strong>.</p>
                                <p>Write the correct letter in boxes 31-35 on your answer sheet.</p>
                            </div>
                            <div class="multiple-choice-container">
                                <div class="multiple-choice-question">
                                    <div class="multiple-choice-prompt">
                                        <strong>31</strong> The studies mentioned in the first paragraph
                                    </div>
                                    <div class="multiple-choice-options">
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q31a" name="q31" value="A">
                                            <label for="q31a"><strong>A</strong> confirm a link between musical training and intelligence.</label>
                                        </div>
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q31b" name="q31" value="B">
                                            <label for="q31b"><strong>B</strong> present misleading information about the value of learning an instrument.</label>
                                        </div>
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q31c" name="q31" value="C">
                                            <label for="q31c"><strong>C</strong> suggest that there are undiscovered benefits to studying music</label>
                                        </div>
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q31d" name="q31" value="D">
                                            <label for="q31d"><strong>D</strong> cast doubt on a belief about the effects of taking music lessons.</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="multiple-choice-question">
                                    <div class="multiple-choice-prompt">
                                        <strong>32</strong> According to the second paragraph, there may be many benefits to studying music,
                                    </div>
                                    <div class="multiple-choice-options">
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q32a" name="q32" value="A">
                                            <label for="q32a"><strong>A</strong> even for those who begin learning in adulthood.</label>
                                        </div>
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q32b" name="q32" value="B">
                                            <label for="q32b"><strong>B</strong> providing the person learns the correct techniques.</label>
                                        </div>
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q32c" name="q32" value="C">
                                            <label for="q32c"><strong>C</strong> especially if the person practices on a regular basis.</label>
                                        </div>
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q32d" name="q32" value="D">
                                            <label for="q32d"><strong>D</strong> particularly if the person plays a range of different instruments.</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="multiple-choice-question">
                                    <div class="multiple-choice-prompt">
                                        <strong>33</strong> The phrase 'this might well be the case' in the fourth paragraph suggests that
                                    </div>
                                    <div class="multiple-choice-options">
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q33a" name="q33" value="A">
                                            <label for="q33a"><strong>A</strong> music lessons and long-term physical well-being may be connected.</label>
                                        </div>
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q33b" name="q33" value="B">
                                            <label for="q33b"><strong>B</strong> the ability to learn music may depend on neurological features.</label>
                                        </div>
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q33c" name="q33" value="C">
                                            <label for="q33c"><strong>C</strong> learning an instrument may have a lasting impact on brain function.</label>
                                        </div>
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q33d" name="q33" value="D">
                                            <label for="q33d"><strong>D</strong> older people's brains may be better suited to studying music than those of children.</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="multiple-choice-question">
                                    <div class="multiple-choice-prompt">
                                        <strong>34</strong> Which aspect of playing an instrument was included in Hanna-Pladdy's follow-up study but not in her first study?
                                    </div>
                                    <div class="multiple-choice-options">
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q34a" name="q34" value="A">
                                            <label for="q34a"><strong>A</strong> the number of years that the person had played</label>
                                        </div>
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q34b" name="q34" value="B">
                                            <label for="q34b"><strong>B</strong> at which age the person began having lessons</label>
                                        </div>
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q34c" name="q34" value="C">
                                            <label for="q34c"><strong>C</strong> the length of time since the person last played</label>
                                        </div>
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q34d" name="q34" value="D">
                                            <label for="q34d"><strong>D</strong> how the person had practiced as a child</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="multiple-choice-question">
                                    <div class="multiple-choice-prompt">
                                        <strong>35</strong> What do Hanna-Pladdy's studies suggest about people's general education?
                                    </div>
                                    <div class="multiple-choice-options">
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q35a" name="q35" value="A">
                                            <label for="q35a"><strong>A</strong> Studying music compensates for an otherwise limited level of education.</label>
                                        </div>
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q35b" name="q35" value="B">
                                            <label for="q35b"><strong>B</strong> Learning to play an instrument improves educational performance.</label>
                                        </div>
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q35c" name="q35" value="C">
                                            <label for="q35c"><strong>C</strong> Highly educated people are more likely to benefit from music training.</label>
                                        </div>
                                        <div class="multiple-choice-option">
                                            <input type="radio" id="q35d" name="q35" value="D">
                                            <label for="q35d"><strong>D</strong> Level of education makes no difference to a person's musical ability.</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="question" data-q-start="36" data-q-end="40">
                            <div class="question-prompt">
                                <p><strong>Questions 36-40</strong><br>Complete each sentence with the correct ending, <strong>A-F</strong>, below.</p>
                                <p>Write the correct letter, <strong>A-F</strong>, in boxes 36-40 on your answer sheet.</p>
                            </div>
                            <div class="example-box">
                                <p><strong>List of endings</strong></p>
                                <p><strong>A</strong> comparing the brains of people who had never played an instrument with those who played for a living.</p>
                                <p><strong>B</strong> activating many different parts of the brain at the same time.</p>
                                <p><strong>C</strong> teaching a group of older people to play an instrument.</p>
                                <p><strong>D</strong> acquiring the particular set of physical skills needed to play an instrument</p>
                                <p><strong>E</strong> discovering which group of people become the best musicians.</p>
                                <p><strong>F</strong> having played an instrument for a considerable length of time.</p>
                            </div>
                            <div class="sentence-completion-container">
                                <div class="sentence-completion-item">
                                    <span><strong>36</strong>&nbsp;&nbsp;Brenda Hanna-Pladdy believes the cognitive benefits of music lessons are a result of</span>
                                    <select class="answer-input" id="q36"><option value=""></option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option></select>
                                </div>
                                <div class="sentence-completion-item">
                                    <span><strong>37</strong>&nbsp;&nbsp;The research undertaken by Gottfried Schlaug focused on</span>
                                    <select class="answer-input" id="q37"><option value=""></option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option></select>
                                </div>
                                <div class="sentence-completion-item">
                                    <span><strong>38</strong>&nbsp;&nbsp;According to Alison Balbag, playing an instrument is a unique experience because it involves</span>
                                    <select class="answer-input" id="q38"><option value=""></option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option></select>
                                </div>
                                <div class="sentence-completion-item">
                                    <span><strong>39</strong>&nbsp;&nbsp;Nina Kraus believes there is a link between better hearing in later life and the experience of</span>
                                    <select class="answer-input" id="q39"><option value=""></option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option></select>
                                </div>
                                <div class="sentence-completion-item">
                                    <span><strong>40</strong>&nbsp;&nbsp;Jennifer Bugos's study involved</span>
                                    <select class="answer-input" id="q40"><option value=""></option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option><option value="E">E</option><option value="F">F</option></select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Arrows -->
    <div class="nav-arrows">
        <button class="nav-arrow" onclick="previousQuestion()" id="prevBtn">‹</button>
        <button class="nav-arrow" onclick="nextQuestion()" id="nextBtn">›</button>
    </div>

    <!-- Bottom Navigation -->
    <nav class="nav-row perScorableItem" aria-label="Questions">
        <div class="footer__questionWrapper selected multiple" role="tablist">
            <button role="tab" class="footer__questionNo" onclick="switchToPart(3)">
                <span>
                    <span aria-hidden="true" class="section-prefix">Part </span>
                    <span class="sectionNr" aria-hidden="true">3</span>
                </span>
            </button>
            <div class="footer__subquestionWrapper">
                <button class="subQuestion" onclick="goToQuestion(27)"><span aria-hidden="true">27</span></button>
                <button class="subQuestion" onclick="goToQuestion(28)"><span aria-hidden="true">28</span></button>
                <button class="subQuestion" onclick="goToQuestion(29)"><span aria-hidden="true">29</span></button>
                <button class="subQuestion" onclick="goToQuestion(30)"><span aria-hidden="true">30</span></button>
                <button class="subQuestion" onclick="goToQuestion(31)"><span aria-hidden="true">31</span></button>
                <button class="subQuestion" onclick="goToQuestion(32)"><span aria-hidden="true">32</span></button>
                <button class="subQuestion" onclick="goToQuestion(33)"><span aria-hidden="true">33</span></button>
                <button class="subQuestion" onclick="goToQuestion(34)"><span aria-hidden="true">34</span></button>
                <button class="subQuestion" onclick="goToQuestion(35)"><span aria-hidden="true">35</span></button>
                <button class="subQuestion" onclick="goToQuestion(36)"><span aria-hidden="true">36</span></button>
                <button class="subQuestion" onclick="goToQuestion(37)"><span aria-hidden="true">37</span></button>
                <button class="subQuestion" onclick="goToQuestion(38)"><span aria-hidden="true">38</span></button>
                <button class="subQuestion" onclick="goToQuestion(39)"><span aria-hidden="true">39</span></button>
                <button class="subQuestion" onclick="goToQuestion(40)"><span aria-hidden="true">40</span></button>
            </div>
        </div>
        
        <button id="deliver-button" aria-label="Review your answers" class="footer__deliverButton">
            <i class="fa fa-check" aria-hidden="true"></i>
            <span>Check Answers</span>
        </button>
    </nav>

    <!-- Results Modal -->
    <div id="results-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="modal-close-btn" onclick="closeResultsModal()">&times;</button>
            <h2>Results</h2>
            <div class="results-summary">
                <p>Score: <span id="results-score"></span> / 14</p>
                <p>IELTS Band: <span id="results-band"></span></p>
            </div>
            <div id="results-details" class="results-details-container">
                <!-- Results for each question will be injected here -->
            </div>
        </div>
    </div>

    <script>
        // --- STATE VARIABLES ---
        let currentPassage = 3;
        let currentQuestion = 27;
        let timeInSeconds = 1200; // 20 minutes
        let timerInterval;
        let draggedItem = null;
        let currentSelection = null;

        // --- DOM ELEMENTS ---
        const timerDisplay = document.querySelector('.timer-display');
        const timerToggleButton = document.getElementById('timer-toggle-btn');
        const timerResetButton = document.getElementById('timer-reset-btn');
        const deliverButton = document.getElementById('deliver-button');
        const resizer = document.getElementById('resizer');
        const highlightToolbar = document.getElementById('highlight-toolbar');

        // --- CORRECT ANSWERS ---
        const correctAnswers = {
            '27': 'NOT GIVEN', '28': 'NO', '29': 'NOT GIVEN', '30': 'YES',
            '31': 'D', '32': 'B', '33': 'C', '34': 'B', '35': 'A',
            '36': 'D', '37': 'A', '38': 'B', '39': 'F', '40': 'C'
        };

        // --- HIGHLIGHT SYSTEM ---
        function initializeHighlightSystem() {
            // Listen for text selection
            document.addEventListener('mouseup', handleTextSelection);
            document.addEventListener('touchend', handleTextSelection);
            
            // Hide toolbar when clicking outside
            document.addEventListener('mousedown', hideHighlightToolbar);
            document.addEventListener('touchstart', hideHighlightToolbar);
            
            // Prevent toolbar from hiding when clicking on it
            highlightToolbar.addEventListener('mousedown', (e) => e.stopPropagation());
            highlightToolbar.addEventListener('touchstart', (e) => e.stopPropagation());
        }

        function handleTextSelection(e) {
            const selection = window.getSelection();
            const selectedText = selection.toString().trim();
            
            if (selectedText.length > 0 && isSelectionInContent(selection)) {
                currentSelection = selection;
                showHighlightToolbar(selection);
            } else {
                hideHighlightToolbar();
            }
        }

        function isSelectionInContent(selection) {
            if (!selection.rangeCount) return false;
            
            const range = selection.getRangeAt(0);
            const passagePanel = document.getElementById('passage-panel');
            const questionsPanel = document.getElementById('questions-panel');
            
            return passagePanel.contains(range.commonAncestorContainer) || 
                   questionsPanel.contains(range.commonAncestorContainer);
        }

        function showHighlightToolbar(selection) {
            if (!selection.rangeCount) return;
            
            const range = selection.getRangeAt(0);
            const rect = range.getBoundingClientRect();
            
            if (rect.width === 0 && rect.height === 0) return;
            
            // Position toolbar above selection
            const toolbarRect = highlightToolbar.getBoundingClientRect();
            let top = rect.top - toolbarRect.height - 10;
            let left = rect.left + (rect.width / 2) - (toolbarRect.width / 2);
            
            // Adjust if toolbar goes off screen
            if (top < 10) top = rect.bottom + 10;
            if (left < 10) left = 10;
            if (left + toolbarRect.width > window.innerWidth - 10) {
                left = window.innerWidth - toolbarRect.width - 10;
            }
            
            highlightToolbar.style.top = (top + window.scrollY) + 'px';
            highlightToolbar.style.left = (left + window.scrollX) + 'px';
            highlightToolbar.style.display = 'flex';
        }

        function hideHighlightToolbar() {
            highlightToolbar.style.display = 'none';
            currentSelection = null;
            window.getSelection().removeAllRanges();
        }

        function applyHighlight(color) {
            if (!currentSelection || !currentSelection.rangeCount) return;
            
            try {
                const range = currentSelection.getRangeAt(0);
                const selectedContent = range.extractContents();
                const span = document.createElement('span');
                
                span.className = `highlight-${color}`;
                span.appendChild(selectedContent);
                range.insertNode(span);
                
                // Clean up empty text nodes
                span.parentNode.normalize();
                
            } catch (error) {
                console.error('Error applying highlight:', error);
            }
            
            hideHighlightToolbar();
        }

        function clearHighlight() {
            if (!currentSelection || !currentSelection.rangeCount) return;
            
            try {
                const range = currentSelection.getRangeAt(0);
                const container = range.commonAncestorContainer;
                
                // Find highlighted elements within selection
                const walker = document.createTreeWalker(
                    container,
                    NodeFilter.SHOW_ELEMENT,
                    {
                        acceptNode: function(node) {
                            return node.classList && 
                                  (node.classList.contains('highlight-yellow') || 
                                   node.classList.contains('highlight-blue')) 
                                ? NodeFilter.FILTER_ACCEPT 
                                : NodeFilter.FILTER_SKIP;
                        }
                    },
                    false
                );
                
                let node;
                const highlightsToRemove = [];
                
                while (node = walker.nextNode()) {
                    if (range.intersectsNode(node)) {
                        highlightsToRemove.push(node);
                    }
                }
                
                // Remove highlights
                highlightsToRemove.forEach(highlight => {
                    const parent = highlight.parentNode;
                    while (highlight.firstChild) {
                        parent.insertBefore(highlight.firstChild, highlight);
                    }
                    parent.removeChild(highlight);
                    parent.normalize();
                });
                
            } catch (error) {
                console.error('Error clearing highlight:', error);
            }
            
            hideHighlightToolbar();
        }

        // --- INITIALIZATION ---
        function initialize() {
            startTimer();
            initializeHighlightSystem();
            switchToPart(3);
            
            document.body.addEventListener('input', updateAllIndicators);
            document.body.addEventListener('change', updateAllIndicators);
            
            deliverButton.addEventListener('click', checkAnswers);
            timerToggleButton.addEventListener('click', toggleTimer);
            timerResetButton.addEventListener('click', resetTimer);

            resizer.addEventListener('mousedown', initResize, false);
            
            updateNavigation();
        }

        // --- CHECK ANSWERS FUNCTION ---
        function checkAnswers() {
            clearInterval(timerInterval);
            let score = 0;
            const resultsDetailsContainer = document.getElementById('results-details');
            resultsDetailsContainer.innerHTML = '';

            // Clear previous markings
            document.querySelectorAll('.correct, .incorrect').forEach(el => {
                el.classList.remove('correct', 'incorrect');
            });

            // Check each question from 27 to 40
            for (let qNum = 27; qNum <= 40; qNum++) {
                const correctAnswer = correctAnswers[qNum];
                let userAnswer = '';
                let isCorrect = false;

                // Get user answer based on question type
                if (qNum >= 27 && qNum <= 30) {
                    // YES/NO/NOT GIVEN questions (27-30)
                    const selectInput = document.getElementById(`q${qNum}`);
                    if (selectInput) {
                        userAnswer = selectInput.value;
                        isCorrect = userAnswer === correctAnswer;
                        
                        selectInput.classList.add(isCorrect ? 'correct' : 'incorrect');
                        selectInput.closest('.paragraph-matching-question').classList.add(isCorrect ? 'correct' : 'incorrect');
                    }
                } else if (qNum >= 31 && qNum <= 35) {
                    // Multiple choice questions (31-35)
                    const radioInput = document.querySelector(`input[name="q${qNum}"]:checked`);
                    if (radioInput) {
                        userAnswer = radioInput.value;
                        isCorrect = userAnswer === correctAnswer;
                        
                        // Mark the radio options
                        const allOptions = document.querySelectorAll(`input[name="q${qNum}"]`);
                        allOptions.forEach(option => {
                            const optionContainer = option.closest('.multiple-choice-option');
                            if (option.value === correctAnswer) {
                                optionContainer.classList.add('correct');
                            } else if (option.checked && !isCorrect) {
                                optionContainer.classList.add('incorrect');
                            }
                        });
                    }
                } else if (qNum >= 36 && qNum <= 40) {
                    // Sentence completion questions (36-40)
                    const selectInput = document.getElementById(`q${qNum}`);
                    if (selectInput) {
                        userAnswer = selectInput.value;
                        isCorrect = userAnswer === correctAnswer;
                        
                        selectInput.classList.add(isCorrect ? 'correct' : 'incorrect');
                        selectInput.closest('.sentence-completion-item').classList.add(isCorrect ? 'correct' : 'incorrect');
                    }
                }

                // Update score
                if (isCorrect) {
                    score++;
                }

                // Update question buttons
                const subQuestionBtn = document.querySelector(`.subQuestion[onclick="goToQuestion(${qNum})"]`);
                if (subQuestionBtn) {
                    subQuestionBtn.classList.add(isCorrect ? 'correct' : 'incorrect');
                }

                // Add to results modal
                const userAnswerDisplay = userAnswer || 'Not answered';
                
                const resultRow = document.createElement('div');
                resultRow.className = `result-row ${isCorrect ? '' : 'incorrect'}`;
                resultRow.innerHTML = `
                    <span class="q-num">${qNum}</span>
                    <span class="user-ans">${userAnswerDisplay}</span>
                    <span class="correct-ans">${correctAnswer}</span>
                `;
                resultsDetailsContainer.appendChild(resultRow);
            }

            // Update score display
            document.getElementById('results-score').textContent = score;
            document.getElementById('results-band').textContent = calculateBandScore(score);
            
            // Show results modal
            document.getElementById('results-modal').classList.remove('hidden');
            
            // Disable inputs after checking
            disableInputs();
        }

        function calculateBandScore(score) {
            const mapping = {
                14: '9.0', 13: '9.0', 12: '8.5', 11: '8.5', 
                10: '8.0', 9: '8.0', 8: '7.5', 7: '7.5',
                6: '7.0', 5: '7.0', 4: '6.5', 3: '6.5',
                2: '6.0', 1: '6.0', 0: '0.0'
            };
            return mapping[score] || '0.0';
        }

        function disableInputs() {
            deliverButton.innerHTML = `<span>Checked! View Results.</span>`;
            deliverButton.onclick = showResultsModal;

            // Disable all inputs
            document.querySelectorAll('input, select').forEach(el => {
                el.disabled = true;
            });
        }

        function showResultsModal() {
            document.getElementById('results-modal').classList.remove('hidden');
        }

        window.closeResultsModal = function() {
            document.getElementById('results-modal').classList.add('hidden');
        }

        // --- TIMER FUNCTIONS ---
        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeInSeconds--;
                const minutes = Math.floor(timeInSeconds / 60);
                const seconds = timeInSeconds % 60;
                timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                if (timeInSeconds <= 0) {
                    clearInterval(timerInterval);
                    timerDisplay.textContent = "Time's up!";
                    checkAnswers();
                }
            }, 1000);
            timerToggleButton.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>';
        }

        function pauseTimer() {
            clearInterval(timerInterval);
            timerToggleButton.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M8 5v14l11-7L8 5z"/></svg>';
        }

        function toggleTimer() {
            if (timerToggleButton.innerHTML.includes('M6 19h4V5H6v14z')) {
                pauseTimer();
            } else {
                startTimer();
            }
        }

        function resetTimer() {
            pauseTimer();
            timeInSeconds = 1200;
            timerDisplay.textContent = '20:00';
            startTimer();
        }

        // --- NAVIGATION ---
        window.switchToPart = function(partNumber) {
            currentPassage = partNumber;
            document.querySelectorAll('.reading-passage, .question-set, .part-header').forEach(el => el.classList.add('hidden'));
            document.getElementById(`passage-text-${partNumber}`)?.classList.remove('hidden');
            document.getElementById(`questions-${partNumber}`)?.classList.remove('hidden');
            document.getElementById(`part-header-${partNumber}`)?.classList.remove('hidden');
            
            goToQuestion(27);
        }
        
        window.goToQuestion = function(questionNumber) {
            currentQuestion = questionNumber;
            updateNavigation();
            
            // Scroll to the question
            const questionElement = document.querySelector(`[data-q-start="${questionNumber}"]`);
            if (questionElement) {
                questionElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function updateNavigation() {
            document.querySelectorAll('.subQuestion').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.subQuestion[onclick="goToQuestion(${currentQuestion})"]`)?.classList.add('active');
            
            document.getElementById('prevBtn').disabled = currentQuestion === 27;
            document.getElementById('nextBtn').disabled = currentQuestion === 40;
        }
        
        window.nextQuestion = () => currentQuestion < 40 && goToQuestion(currentQuestion + 1);
        window.previousQuestion = () => currentQuestion > 27 && goToQuestion(currentQuestion - 1);

        function updateAllIndicators() {
            updateAnsweredIndicators();
        }
        
        function updateAnsweredIndicators() {
            for (let qNum = 27; qNum <= 40; qNum++) {
                const btn = document.querySelector(`.subQuestion[onclick="goToQuestion(${qNum})"]`);
                if (!btn || btn.classList.contains('correct') || btn.classList.contains('incorrect')) continue;

                let isAnswered = false;

                if (qNum >= 27 && qNum <= 30) {
                    const selectInput = document.getElementById(`q${qNum}`);
                    isAnswered = selectInput && selectInput.value !== '';
                } else if (qNum >= 31 && qNum <= 35) {
                    const radioInput = document.querySelector(`input[name="q${qNum}"]:checked`);
                    isAnswered = radioInput !== null;
                } else if (qNum >= 36 && qNum <= 40) {
                    const selectInput = document.getElementById(`q${qNum}`);
                    isAnswered = selectInput && selectInput.value !== '';
                }
                
                btn.classList.toggle('answered', isAnswered);
            }
        }

        // --- RESIZER ---
        function initResize(e) {
            e.preventDefault();
            const startX = e.clientX;
            const startWidth = document.getElementById('passage-panel').offsetWidth;
            
            const doDrag = (e) => {
                const newWidth = startWidth + e.clientX - startX;
                if (newWidth > 200 && (document.body.clientWidth - newWidth - resizer.offsetWidth) > 200) {
                    document.getElementById('passage-panel').style.flex = `0 0 ${newWidth}px`;
                }
            };
            
            const stopDrag = () => {
                window.removeEventListener('mousemove', doDrag, false);
                window.removeEventListener('mouseup', stopDrag, false);
            };
            
            window.addEventListener('mousemove', doDrag, false);
            window.addEventListener('mouseup', stopDrag, false);
        }

        // --- START THE APP ---
        document.addEventListener('DOMContentLoaded', initialize);
    </script>
</body>
</html>