<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Reading Test: Unfair Advantage in Sport</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6c5ce7;
            --secondary: #a29bfe;
            --accent: #fd79a8;
            --text: #2d3436;
            --bg: #f7f7f7;
            --card-bg: #ffffff;
            --shadow: rgba(0, 0, 0, 0.1);
            --highlight-yellow: rgba(255, 255, 0, 0.3);
            --highlight-blue: rgba(173, 216, 230, 0.3);
            --transition: all 0.3s ease;
        }

        .night-theme {
            --primary: #a29bfe;
            --secondary: #6c5ce7;
            --accent: #ff7675;
            --text: #dfe6e9;
            --bg: #2d3436;
            --card-bg: #3c4245;
            --shadow: rgba(0, 0, 0, 0.3);
        }

        .sepia-theme {
            --primary: #a17c5f;
            --secondary: #d9bca3;
            --accent: #e67e22;
            --text: #4a3c2a;
            --bg: #f5ecd7;
            --card-bg: #faf3e6;
            --shadow: rgba(118, 93, 64, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: var(--transition);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: var(--primary);
            color: white;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px var(--shadow);
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            display: flex;
            align-items: center;
        }

        .logo i {
            margin-right: 10px;
        }

        .theme-selector {
            display: flex;
            gap: 10px;
        }

        .theme-btn {
            background: var(--card-bg);
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px var(--shadow);
        }

        .theme-btn:hover {
            transform: scale(1.1);
        }

        .telegram-btn {
            background: #0088cc;
            color: white;
            text-decoration: none;
            padding: 10px 15px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            font-weight: 500;
            box-shadow: 0 2px 5px var(--shadow);
        }

        .telegram-btn i {
            margin-right: 8px;
        }

        .telegram-btn:hover {
            background: #0077b5;
            transform: translateY(-2px);
        }

        .timer-container {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .timer {
            background: var(--card-bg);
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 1.5rem;
            font-weight: bold;
            box-shadow: 0 4px 12px var(--shadow);
            display: flex;
            align-items: center;
        }

        .timer i {
            margin-right: 10px;
            color: var(--accent);
        }

        .timer.warning {
            color: #e74c3c;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .content {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 992px) {
            .content {
                flex-direction: column;
            }
        }

        .passage-container {
            flex: 1;
            background: var(--card-bg);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px var(--shadow);
            max-height: 70vh;
            overflow-y: auto;
        }

        .passage-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--primary);
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 10px;
        }

        .passage-text {
            font-size: 1.1rem;
            line-height: 1.8;
        }

        .passage-text p {
            margin-bottom: 15px;
        }

        .questions-container {
            flex: 1;
            background: var(--card-bg);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px var(--shadow);
            max-height: 70vh;
            overflow-y: auto;
        }

        .questions-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--primary);
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 10px;
        }

        .question {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--secondary);
        }

        .question-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .option {
            background: var(--bg);
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            border: 1px solid transparent;
        }

        .option:hover {
            background: var(--secondary);
            color: white;
        }

        .option.selected {
            background: var(--primary);
            color: white;
        }

        .input-answer {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid var(--secondary);
            background: var(--bg);
            color: var(--text);
            margin-top: 5px;
        }

        .submit-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }

        .submit-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 12px;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: 0 4px 12px var(--shadow);
            display: flex;
            align-items: center;
        }

        .submit-btn i {
            margin-right: 10px;
            color: white;
        }

        .submit-btn:hover {
            background: var(--secondary);
            transform: translateY(-3px);
        }

        .result-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .result-content {
            background: var(--card-bg);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            border-radius: 12px;
            padding: 30px;
            overflow-y: auto;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);
        }

        .result-header {
            text-align: center;
            margin-bottom: 25px;
            color: var(--primary);
        }

        .score {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 20px 0;
            text-align: center;
        }

        .result-details {
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        .result-item {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            background: var(--bg);
        }

        .correct {
            border-left: 5px solid #2ecc71;
        }

        .incorrect {
            border-left: 5px solid #e74c3c;
        }

        .close-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            display: block;
            margin: 25px auto 0;
        }

        .close-btn:hover {
            background: var(--secondary);
        }

        .highlight-menu {
            position: absolute;
            background: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 3px 10px var(--shadow);
            padding: 5px;
            display: none;
            z-index: 100;
        }

        .highlight-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: none;
            margin: 0 5px;
            cursor: pointer;
        }

        .yellow {
            background: #ffeb3b;
        }

        .blue {
            background: #03a9f4;
        }

        .clear {
            background: #e74c3c;
            color: white;
            font-size: 12px;
        }

        .highlight-yellow {
            background-color: var(--highlight-yellow);
        }

        .highlight-blue {
            background-color: var(--highlight-blue);
        }

        footer {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            color: var(--text);
            opacity: 0.8;
            font-size: 0.9rem;
        }

        .headings-list {
            list-style-type: none;
            padding: 0;
            background: var(--bg);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .headings-list li {
            padding: 8px 0;
            border-bottom: 1px solid var(--secondary);
        }

        .headings-list li:last-child {
            border-bottom: none;
        }

        .checkbox-option {
            display: flex;
            align-items: center;
            margin: 8px 0;
        }

        .checkbox-option input {
            margin-right: 10px;
        }

        .heading-select {
            width: 100%;
            padding: 8px;
            border-radius: 6px;
            border: 1px solid var(--secondary);
            background: var(--bg);
            color: var(--text);
            margin-top: 5px;
        }

        .answer-number {
            font-weight: bold;
            color: var(--primary);
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">
            <i class="fas fa-running"></i>
            <span>IELTS Reading: Unfair Advantage</span>
        </div>
        <div class="theme-selector">
            <button class="theme-btn" id="day-theme" title="Day Theme"><i class="fas fa-sun"></i></button>
            <button class="theme-btn" id="night-theme" title="Night Theme"><i class="fas fa-moon"></i></button>
            <button class="theme-btn" id="sepia-theme" title="Sepia Theme"><i class="fas fa-seedling"></i></button>
        </div>
        <a href="tg://resolve?domain=aftum_8" class="telegram-btn">
            <i class="fab fa-telegram"></i>
            Телеграмм канал
        </a>
    </header>

    <div class="container">
        <div class="timer-container">
            <div class="timer" id="timer">
                <i class="fas fa-clock"></i>
                <span>20:00</span>
            </div>
        </div>

        <div class="content">
            <div class="passage-container">
                <h2 class="passage-title">Passage 2: What is an unfair advantage in sport?</h2>
                <div class="passage-text" id="passage-text">
                    <p><strong>A</strong> What happened to the Australian athlete Ron Clarke in the 10,000 metres at the Mexico City Olympics of 1968 is now virtually forgotten, though at the time it was headline news. Clarke was the greatest distance runner in history he'd broken more world records than anybody else. But in front of 55,000 horrified spectators, the event went disastrously wrong in the third lap, one runner keeled over and with six laps to go, two more were carried away. Yet the race was being conducted at a relatively leisurely speed: the halfway time was the slowest since the Paris Olympics of 1924 With two laps to go. Clarke was in the leading pack. I'd never felt better in a race, he says. But suddenly he too began to struggle, and as the frontrunners moved up a gear, a gap opened up. Clarke remembers nothing of his last lap which he ran in 90 seconds Normally I would run it in 64, he explains He stumbled across the line in sixth place and collapsed, He was administered oxygen and stretchered off the track.</p>
                    
                    <p><strong>B</strong> Mexico City is surrounded by mountains and is over 2,240 metres above sea level. That the altitude would have an impact on the Games was predicted Clarke had raised the issue himself, but had been told by the Australian sports authorities that complaining was regarded as bad sportsmanship. As it turned out, he had good reason to do so Cleary, the link between athletic performance and altitude needed further investigation.</p>
                    
                    <p><strong>C</strong> Although there were few standout performances in distance running at the Mexico Games, they marked a turning point: the start of an astonishing record of success by east Africans. While Clarke lay crumpled in a heap, runners from Kenya and Ethiopia were celebrating their gold and silver medals. The record books confirm how entrenched this pattern has become. The names of the seven fastest men in history over 5,000 metres are Bekele, Gebreslassie, Komen, Kipchoge, Shine, Songkok and Chereno. They are all from either Kenya or Ethiopia. Between 1997 and 2011 the 10,000 metres mens world record was smashed five times, dropping from 26:31.32 to 26:17.53. Each time, the record was broken by a Kenyan or an Ethiopian. While there is a complex mix of economic, political, social and cultural explanations for the pre-eminence of east Africans, one factor is surely that many of these athletes have lived most of their lives in thin air.</p>
                    
                    <p><strong>D</strong> At high altitudes, a number of physiological alterations occur, most importantly. more red blood cells and haemoglobin are produced. This, in turn, increases the capacity of the blood to carry oxygen, which feeds the muscles and which gives an advantage to the athletes when they return to sea level. However, it is impossible to train with the same level of intensity in the mountains-aerobic capacity and cardio-respiratory function both suffer at altitude. As a result, the consensus is that the optimum approach to athletic preparation is: Live High, Train Low (LHTL) Yet that has obvious practical drawbacks. Not many people live in the mountains and those who do would prefer not to spend several hours each day driving up and down winding treacherous roads.</p>
                    
                    <p><strong>E</strong> That's where the altitude tent-sometimes called the hypoxic tent-comes in Around two decades ago, two different scientists had the same exciting thought. If they could artificially control the atmosphere within a confined space, they could simulate the effects of high altitude and save an athlete at sea-level from the time and expense of travelling to higher ground. Altitude tents have improved over the years: they're not as hot or as noisy as the early prototypes, and are much cheaper too. They are also perfectly lawful. Five years ago when the tents were investigated by Wada (the World Anti Doping Agency), it was ruled that they did not violate the spirit of distance running. It is now routine for athletes to sleep in them in preparation for an event.</p>
                    
                    <p><strong>F</strong> However, it is not the case that all new technologies gain approval. In 2008, a staggering 105 world records were broken in swimming, the vast majority achieved by competitors wearing the new Speedo L2R Racer suit These suits use a high-tech fabric tested in Nasa's wind tunnels, which reduces drag and improves buoyancy. The L2R was initially sanctioned by Fina, the international swimming body. But as better suits were produced by Speedo and other manufacturers, and more records were broken, they became increasingly controversial. In a 2009 ruling, Fina changed its mind. Banning all suits made with this high-tech fabric.</p>
                    
                    <p><strong>G</strong> Going faster, higher , stronger is integral to the logic of athletics in general, and the Olympics in particular. Athletes believe they need records all the time. And the only way minute changes of 0.0001 of a second. But when a new technology is invented, the relevant sports authority has to consider whether to embrace or reject it. In some cases, athletes are granted permission to use the technology: in others, it is banned. But whatever the outcome, rulings should not appear arbitrary: arguments have to be examined and weighed and the rules of logic ought to apply in every case.</p>
                </div>
            </div>

            <div class="questions-container">
                <h2 class="questions-title">Questions 14-26</h2>
                
                <div class="question">
                    <p class="question-title">Questions 14-20</p>
                    <p>Reading Passage 2 has seven paragraphs, A-G.</p>
                    <p>Choose the correct heading for each paragraph from the list of headings below.</p>
                    <p>Write the correct number, <strong>i-ix</strong>, in boxes 14-20 on your answer sheet.</p>
                    
                    <ol class="headings-list" type="i">
                        <li>Early research into athletes' physiology</li>
                        <li>A convenient method of acclimatization</li>
                        <li>The need for a rational approach</li>
                        <li>Changes in the body</li>
                        <li>The athletes who break the rules</li>
                        <li>Well-founded concerns</li>
                        <li>The surprising outcome of a race</li>
                        <li>The reversal of a decision</li>
                        <li>The runners who dominate</li>
                    </ol>
                    
                    <div class="question">
                        <p>14. Paragraph A</p>
                        <select class="heading-select" data-number="14">
                            <option value="">Select heading</option>
                            <option value="i">i</option>
                            <option value="ii">ii</option>
                            <option value="iii">iii</option>
                            <option value="iv">iv</option>
                            <option value="v">v</option>
                            <option value="vi">vi</option>
                            <option value="vii">vii</option>
                            <option value="viii">viii</option>
                            <option value="ix">ix</option>
                        </select>
                    </div>
                    
                    <div class="question">
                        <p>15. Paragraph B</p>
                        <select class="heading-select" data-number="15">
                            <option value="">Select heading</option>
                            <option value="i">i</option>
                            <option value="ii">ii</option>
                            <option value="iii">iii</option>
                            <option value="iv">iv</option>
                            <option value="v">v</option>
                            <option value="vi">vi</option>
                            <option value="vii">vii</option>
                            <option value="viii">viii</option>
                            <option value="ix">ix</option>
                        </select>
                    </div>
                    
                    <div class="question">
                        <p>16. Paragraph C</p>
                        <select class="heading-select" data-number="16">
                            <option value="">Select heading</option>
                            <option value="i">i</option>
                            <option value="ii">ii</option>
                            <option value="iii">iii</option>
                            <option value="iv">iv</option>
                            <option value="v">v</option>
                            <option value="vi">vi</option>
                            <option value="vii">vii</option>
                            <option value="viii">viii</option>
                            <option value="ix">ix</option>
                        </select>
                    </div>
                    
                    <div class="question">
                        <p>17. Paragraph D</p>
                        <select class="heading-select" data-number="17">
                            <option value="">Select heading</option>
                            <option value="i">i</option>
                            <option value="ii">ii</option>
                            <option value="iii">iii</option>
                            <option value="iv">iv</option>
                            <option value="v">v</option>
                            <option value="vi">vi</option>
                            <option value="vii">vii</option>
                            <option value="viii">viii</option>
                            <option value="ix">ix</option>
                        </select>
                    </div>
                    
                    <div class="question">
                        <p>18. Paragraph E</p>
                        <select class="heading-select" data-number="18">
                            <option value="">Select heading</option>
                            <option value="i">i</option>
                            <option value="ii">ii</option>
                            <option value="iii">iii</option>
                            <option value="iv">iv</option>
                            <option value="v">v</option>
                            <option value="vi">vi</option>
                            <option value="vii">vii</option>
                            <option value="viii">viii</option>
                            <option value="ix">ix</option>
                        </select>
                    </div>
                    
                    <div class="question">
                        <p>19. Paragraph F</p>
                        <select class="heading-select" data-number="19">
                            <option value="">Select heading</option>
                            <option value="i">i</option>
                            <option value="ii">ii</option>
                            <option value="iii">iii</option>
                            <option value="iv">iv</option>
                            <option value="v">v</option>
                            <option value="vi">vi</option>
                            <option value="vii">vii</option>
                            <option value="viii">viii</option>
                            <option value="ix">ix</option>
                        </select>
                    </div>
                    
                    <div class="question">
                        <p>20. Paragraph G</p>
                        <select class="heading-select" data-number="20">
                            <option value="">Select heading</option>
                            <option value="i">i</option>
                            <option value="ii">ii</option>
                            <option value="iii">iii</option>
                            <option value="iv">iv</option>
                            <option value="v">v</option>
                            <option value="vi">vi</option>
                            <option value="vii">vii</option>
                            <option value="viii">viii</option>
                            <option value="ix">ix</option>
                        </select>
                    </div>
                </div>
                
                <div class="question">
                    <p class="question-title">Questions 21 and 22</p>
                    <p>Choose <strong>TWO</strong> letters, <strong>A-E</strong></p>
                    <p>Write the correct letters in boxes 21 and 22 on your answer sheet.</p>
                    <p>Which <strong>TWO</strong> of the following statements about Ron Clarke are made in the passage?</p>
                    
                    <div class="checkbox-option">
                        <input type="checkbox" id="optionA" data-value="A">
                        <label for="optionA">A. Clarke was not performing well immediately prior to the Mexico Games.</label>
                    </div>
                    
                    <div class="checkbox-option">
                        <input type="checkbox" id="optionB" data-value="B">
                        <label for="optionB">B. The worries Clarke had before the Mexico Games were not taken into account.</label>
                    </div>
                    
                    <div class="checkbox-option">
                        <input type="checkbox" id="optionC" data-value="C">
                        <label for="optionC">C. Clarke's experiences at the Mexico Games are widely talked about today.</label>
                    </div>
                    
                    <div class="checkbox-option">
                        <input type="checkbox" id="optionD" data-value="D">
                        <label for="optionD">D. At one stage of the Mexico Games 10,000 metres, Clarke was near the front.</label>
                    </div>
                    
                    <div class="checkbox-option">
                        <input type="checkbox" id="optionE" data-value="E">
                        <label for="optionE">E. Clarke was the only runner at the Mexico Games who appeared to be affected by the altitude.</label>
                    </div>
                </div>
                
                <div class="question">
                    <p class="question-title">Questions 23-26</p>
                    <p>Complete the summary below.</p>
                    <p>Choose <strong>ONE WORD ONLY</strong> from the passage for each answer.</p>
                    <p>Write your answers in boxes 23-26 on your answer sheet.</p>
                    
                    <div class="question">
                        <p><strong>Do all new technologies gain approval?</strong></p>
                        <p>Some people may be puzzled by attitudes towards performance-enhancing technologies in sport. For example, why is the altitude tent considered acceptable, but not the LZR Racer suit? For distance running. Wada concluded that the attitude tent was not contrary to the <span class="answer-number">23</span> <input type="text" class="input-answer" data-number="23"> of the sport. However, the LZR swimsuit, which is made from a special fabric that aids buoyancy and cuts down <span class="answer-number">24</span> <input type="text" class="input-answer" data-number="24"> was banned.</p>
                        
                        <p>Athletes think they have to continually set fresh <span class="answer-number">25</span> <input type="text" class="input-answer" data-number="25">. This is made possible by better nutrition and training, as well as improved clothing and equipment. However, when sports authorities have to decide whether to give permission for a new performance-enhancing technology to be used, it is important that their decisions are not seen as <span class="answer-number">26</span> <input type="text" class="input-answer" data-number="26">.</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="submit-container">
            <button class="submit-btn" id="submit-btn">
                <i class="fas fa-paper-plane"></i>
                Submit Answers
            </button>
        </div>
    </div>

    <div class="result-container" id="result-container">
        <div class="result-content">
            <h2 class="result-header">Test Results</h2>
            <div class="score" id="score">Score: 0/13</div>
            
            <div class="result-details">
                <h3>Question Details:</h3>
                <div id="result-items"></div>
            </div>
            
            <button class="close-btn" id="close-btn">Close Results</button>
        </div>
    </div>

    <div class="highlight-menu" id="highlight-menu">
        <button class="highlight-btn yellow" title="Yellow Highlight"><i class="fas fa-highlighter"></i></button>
        <button class="highlight-btn blue" title="Blue Highlight"><i class="fas fa-highlighter"></i></button>
        <button class="highlight-btn clear" title="Clear Highlight">X</button>
    </div>

    <footer>
        <p>IELTS Reading Practice Test &copy; 2023</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Theme switching
            const dayThemeBtn = document.getElementById('day-theme');
            const nightThemeBtn = document.getElementById('night-theme');
            const sepiaThemeBtn = document.getElementById('sepia-theme');
            const body = document.body;
            
            dayThemeBtn.addEventListener('click', () => {
                body.className = '';
            });
            
            nightThemeBtn.addEventListener('click', () => {
                body.className = 'night-theme';
            });
            
            sepiaThemeBtn.addEventListener('click', () => {
                body.className = 'sepia-theme';
            });
            
            // Timer functionality
            const timerElement = document.getElementById('timer');
            let timeLeft = 20 * 60; // 20 minutes in seconds
            let timerInterval;
            
            function startTimer() {
                clearInterval(timerInterval);
                timerInterval = setInterval(() => {
                    const minutes = Math.floor(timeLeft / 60);
                    const seconds = timeLeft % 60;
                    
                    timerElement.innerHTML = `<i class="fas fa-clock"></i><span>${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}</span>`;
                    
                    if (timeLeft === 5 * 60) {
                        timerElement.classList.add('warning');
                    }
                    
                    if (timeLeft === 0) {
                        clearInterval(timerInterval);
                        submitAnswers();
                    } else {
                        timeLeft--;
                    }
                }, 1000);
            }
            
            startTimer();
            
            // Highlighting functionality
            const passageText = document.getElementById('passage-text');
            const highlightMenu = document.getElementById('highlight-menu');
            let currentSelection = null;
            
            passageText.addEventListener('mouseup', (e) => {
                const selection = window.getSelection();
                if (!selection.toString().trim()) return;
                
                currentSelection = selection;
                
                // Position the menu near the selection
                const range = selection.getRangeAt(0);
                const rect = range.getBoundingClientRect();
                
                highlightMenu.style.display = 'flex';
                highlightMenu.style.position = 'absolute';
                highlightMenu.style.top = `${rect.bottom + window.scrollY + 5}px`;
                highlightMenu.style.left = `${rect.left + window.scrollX}px`;
            });
            
            document.addEventListener('mousedown', (e) => {
                if (!highlightMenu.contains(e.target)) {
                    highlightMenu.style.display = 'none';
                }
            });
            
            // Highlight buttons functionality
            const yellowBtn = document.querySelector('.highlight-btn.yellow');
            const blueBtn = document.querySelector('.highlight-btn.blue');
            const clearBtn = document.querySelector('.highlight-btn.clear');
            
            yellowBtn.addEventListener('click', () => {
                if (currentSelection) {
                    highlightSelection('yellow');
                }
            });
            
            blueBtn.addEventListener('click', () => {
                if (currentSelection) {
                    highlightSelection('blue');
                }
            });
            
            clearBtn.addEventListener('click', () => {
                if (currentSelection) {
                    clearHighlight();
                }
            });
            
            function highlightSelection(color) {
                const range = currentSelection.getRangeAt(0);
                const selectedText = range.extractContents();
                const span = document.createElement('span');
                
                span.appendChild(selectedText);
                span.classList.add(`highlight-${color}`);
                
                range.insertNode(span);
                highlightMenu.style.display = 'none';
                
                // Clear selection
                window.getSelection().removeAllRanges();
            }
            
            function clearHighlight() {
                const range = currentSelection.getRangeAt(0);
                const parent = range.commonAncestorContainer;
                
                if (parent.nodeType !== 3) {
                    const span = parent.closest('span[class*="highlight-"]');
                    if (span) {
                        const text = document.createTextNode(span.textContent);
                        span.parentNode.replaceChild(text, span);
                    }
                }
                
                highlightMenu.style.display = 'none';
                window.getSelection().removeAllRanges();
            }
            
            // Submit answers and show results
            const submitBtn = document.getElementById('submit-btn');
            const resultContainer = document.getElementById('result-container');
            const scoreElement = document.getElementById('score');
            const resultItemsContainer = document.getElementById('result-items');
            const closeBtn = document.getElementById('close-btn');
            
            submitBtn.addEventListener('click', submitAnswers);
            closeBtn.addEventListener('click', () => {
                resultContainer.style.display = 'none';
            });
            
            function submitAnswers() {
                clearInterval(timerInterval);
                
                // Calculate score
                let score = 0;
                const results = [];
                
                // Check paragraph heading questions
                const headingSelects = document.querySelectorAll('.heading-select');
                const correctHeadingAnswers = [
                    'vii', 'vi', 'ix', 'iv', 'ii', 'viii', 'iii'
                ];
                
                headingSelects.forEach((select, index) => {
                    const userAnswer = select.value.toLowerCase();
                    const correctAnswer = correctHeadingAnswers[index].toLowerCase();
                    const isCorrect = userAnswer === correctAnswer;
                    
                    if (isCorrect) score++;
                    
                    results.push({
                        question: index + 14,
                        userAnswer: userAnswer || 'Not answered',
                        correctAnswer: correctHeadingAnswers[index],
                        isCorrect
                    });
                });
                
                // Check multiple choice questions
                const checkboxes = document.querySelectorAll('.checkbox-option input');
                const correctCheckboxAnswers = ['B', 'D'];
                const userCheckboxAnswers = [];
                
                checkboxes.forEach(checkbox => {
                    if (checkbox.checked) {
                        userCheckboxAnswers.push(checkbox.dataset.value);
                    }
                });
                
                // Check if both correct answers are selected
                const isCheckboxCorrect = correctCheckboxAnswers.every(answer => 
                    userCheckboxAnswers.includes(answer)
                ) && userCheckboxAnswers.length === 2;
                
                if (isCheckboxCorrect) score++;
                
                results.push({
                    question: '21-22',
                    userAnswer: userCheckboxAnswers.join(', ') || 'Not answered',
                    correctAnswer: 'B, D',
                    isCorrect: isCheckboxCorrect
                });
                
                // Check summary completion questions
                const summaryAnswers = document.querySelectorAll('.input-answer[data-number="23"], .input-answer[data-number="24"], .input-answer[data-number="25"], .input-answer[data-number="26"]');
                const correctSummaryAnswers = [
                    'spirit', 'drag', 'records', 'arbitrary'
                ];
                
                summaryAnswers.forEach((input, index) => {
                    const userAnswer = input.value.trim().toLowerCase();
                    const correctAnswer = correctSummaryAnswers[index].toLowerCase();
                    const isCorrect = userAnswer === correctAnswer;
                    
                    if (isCorrect) score++;
                    
                    results.push({
                        question: index + 23,
                        userAnswer: userAnswer || 'Not answered',
                        correctAnswer: correctSummaryAnswers[index],
                        isCorrect
                    });
                });
                
                // Display results
                scoreElement.textContent = `Score: ${score}/13`;
                
                resultItemsContainer.innerHTML = '';
                results.forEach(result => {
                    const item = document.createElement('div');
                    item.classList.add('result-item');
                    item.classList.add(result.isCorrect ? 'correct' : 'incorrect');
                    
                    item.innerHTML = `
                        <p><strong>Question ${result.question}:</strong> ${result.isCorrect ? 'Correct' : 'Incorrect'}</p>
                        <p>Your answer: ${result.userAnswer}</p>
                        <p>Correct answer: ${result.correctAnswer}</p>
                    `;
                    
                    resultItemsContainer.appendChild(item);
                });
                
                resultContainer.style.display = 'flex';
            }
        });
    </script>
</body>
</html>